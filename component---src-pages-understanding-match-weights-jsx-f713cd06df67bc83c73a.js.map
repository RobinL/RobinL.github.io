{"version":3,"sources":["webpack://gatsby-starter-hello-world/./node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js","webpack://gatsby-starter-hello-world/./src/components/linkage_footer.jsx","webpack://gatsby-starter-hello-world/./src/components/prob_linkage_page.jsx","webpack://gatsby-starter-hello-world/./node_modules/@robinl/understanding-match-weights/79750b3b8e929d9d@209.js","webpack://gatsby-starter-hello-world/./node_modules/@robinl/understanding-match-weights/ef62bc8f8c0d577e@90.js","webpack://gatsby-starter-hello-world/./node_modules/@robinl/understanding-match-weights/843cb6e82d7c3d9b@474.js","webpack://gatsby-starter-hello-world/./node_modules/@robinl/understanding-match-weights/d25176b0fe784ad0@488.js","webpack://gatsby-starter-hello-world/./node_modules/@robinl/understanding-match-weights/ea6530af059f37be@228.js","webpack://gatsby-starter-hello-world/./node_modules/@robinl/understanding-match-weights/817db6818ab226c0@104.js","webpack://gatsby-starter-hello-world/./node_modules/@robinl/understanding-match-weights/86fc30325e4106c4@851.js","webpack://gatsby-starter-hello-world/./node_modules/@robinl/understanding-match-weights/94c3728fad39c9e8@644.js","webpack://gatsby-starter-hello-world/./src/pages/understanding_match_weights.jsx"],"names":["_taggedTemplateLiteral","strings","raw","slice","Object","freeze","defineProperties","value","mar","flex","order_of_articles","props","path","current_path","this_index","indexOf","previous_article","next_article","undefined","to","css","post","define","output_order","className","title","post_frontmatter","description","_templateObject","_templateObject2","_templateObject3","_templateObject4","_templateObject5","_templateObject6","_templateObject7","_templateObject8","_templateObject9","_templateObject10","_templateObject11","_templateObject12","_templateObject13","_templateObject14","_templateObject15","_templateObject16","_templateObject17","_templateObject18","_templateObject19","_templateObject20","_templateObject21","_templateObject22","_templateObject23","_templateObject24","_templateObject25","_templateObject26","_templateObject27","_templateObject28","_templateObject29","_templateObject30","_templateObject31","_templateObject32","_templateObject33","_templateObject34","_templateObject35","_templateObject36","_templateObject37","_templateObject38","_templateObject39","_templateObject40","_templateObject41","_templateObject42","_templateObject43","_templateObject44","_templateObject45","_templateObject46","_templateObject47","_templateObject48","_templateObject49","_templateObject50","_templateObject51","_templateObject52","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","getOwnPropertyDescriptors","defineProperty","runtime","observer","main","module","variable","md","_ref","_callee","require","aq_version","aq_packages","toView","aq","_context","prev","next","concat","sent","Promise","all","map","pkg","addPackage","addTableMethod","override","abrupt","stop","_x","_x2","_x3","_x4","this","op","table","dt","derive","month","d","row_number","diff","Seattle","Chicago","select","orderby","view","height","rollup","corr_sf","corr","corr_chi","fold","as","groupby","min","sun","max","avg","average","med","median","skew","_ref2","s","mean","stdev","objects","html","DEFAULT_NULL","tableStyle","cellStyle","opt","limit","color","columnNames","name","_loop","td","index","row","maxCellWidth","null","style","th","size","toHTML","Record","record_dict","from","as_aq","RecordComparison","record_l","record_r","records","as_dict","t_l","t_r","comparison","join","a","b","suffix","colname_no_suffix","cols_ordered","wide_or_long","as_long","as_wide","child1","import","proportion_of_matches","comparison_columns","num_levels","col_name","u_probabilities","m_probabilities","first_name_l","first_name_r","surname_l","surname_r","date_of_birth_l","get_waterfall_chart","splink_settings","overrides","get_waterfall_chart_data","embed","get_chart_spec","chart_overrides","simplified","term_freqs","data","lookup","get_waterfall_data_lambda_row","get_waterfall_data_other_rows","get_waterfall_data_final_row","lambda_row","waterfall_data_other_rows","rows_except_final","final_row","cumulative_log2_bayes_factor","reduce","Math","pow","get_comparison_column_lookup","log2","gamma_key","u_probability","m_probability","gamma_value","replace","this_cc","value_l","value_r","bayes_factor","column_name","gamma_column_name","gamma_index","level_name","log2_bayes_factor","prob_to_bayes_factor","prob_to_log2_bayes_factor","get_waterfall_row_gamma","includes","base_spec","base_spec_2","JSON","parse","stringify","values","spec","type","field","condition","test","expr","format","config","continuousHeight","continuousWidth","text","subtitle","transform","window","frame","calculate","layer","mark","encoding","y","width","opacity","tooltip","x","axis","labelExpr","labelAlign","labelPadding","grid","tickBand","sort","orient","y2","fontWeight","labelAngle","baseline","dy","strokeWidth","x2Offset","xOffset","x2","scale","zero","resolve","step","$schema","p","bayes_factor_to_prob","log2_b","d3","csv","autoType","then","csv_file","firstname","freq","first_name_lookup","first_name","uid","fname","sname","dob","town","records_r","case_expression","fname_l","fname_r","sname_l","sname_r","dob_l","dob_r","town_l","town_r","get_df_comparison","records_l","df_comparison","get_df_gammas","df_gammas","get_df_e","get_match_probability","df_e","df","relocate","after","prob_to_log2_bf","log2_bf_to_prob","settings","prior_log2_bg","log2_bayes","cc","gamma_col_name","gamma","m","u","l_val","toLowerCase","r_val","tfs","u_l","u_r","u_new","num_columns","comparison_vector","gamma_symbols","m_values","u_values","m_symbols","u_symbols","bayes_factors","log2_bayes_factors","col_names","match_probability","lam","col_name_escaped","bf","get_match_probability_components","toPrecision","lam_m","lam_u","m_tex","u_tex","m_part","u_part","tex","get_m_u_formula_symbols","joined","joined2","get_comparison_vector_symbols_and_numbers","get_m_u_formula_numbers","records_as_dict_l","records_as_dict_r","df_l","df_r","col_order","surname","surname_lookup","_createForOfIteratorHelper","o","allowArrayLike","it","Symbol","iterator","Array","isArray","minLen","_arrayLikeToArray","n","prototype","toString","call","constructor","_unsupportedIterableToArray","F","done","e","_e","f","TypeError","err","normalCompletion","didErr","_e2","return","arr","len","arr2","child2","date_of_birth","example_record_1_l","example_record_1_r","example_1_comparison","k","example_1_row_with_gammas","child3","replace_lookup","querySelectorAll","_step","row_data","_iterator","cells","innerText","trim","accumulator","properties","rowObject","Generators","parseTableData","table_l","observe","notify","keyinput","event","addEventListener","removeEventListener","table_r","df_comparisons_1","splink_settings_1","df_gammas_1","colnames","month_of_birth","example_record_2_l","example_record_2_r","child4","anchor","offset","header","hconcat","labelAnchor","labels","clip","selection","selector076","bind","encodings","range","domain","default_splink_settings","get_chart_row","chart_data","m_u_pair","base_spec_m_u","chart_data_from_splink_settings","splink_setttings","get_m_u_chart","settings_example","base_spec_bayes_factors","get_bayes_factor_chart","comparison_column","df_gammas_only_1","texd","inputs","textarea","rows","spellcheck","G","_","input","numRows","label","row_index","toMarkdown","options","displayMode","fleqn","prior","toLocaleString","radio","fname_radio","sname_radio","dob_radio","town_radio","frontmatter","post_date","code_url","post_type","post_category","css_override"],"mappings":"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","file":"component---src-pages-understanding-match-weights-jsx-f713cd06df67bc83c73a.js","sourcesContent":["export default function _taggedTemplateLiteral(strings, raw) {\n  if (!raw) {\n    raw = strings.slice(0);\n  }\n\n  return Object.freeze(Object.defineProperties(strings, {\n    raw: {\n      value: Object.freeze(raw)\n    }\n  }));\n}","import React from 'react'\nimport { css } from \"@emotion/core\"\nimport { rhythm } from \"../utils/typography\"\nimport { Link } from \"gatsby\"\n\n\nconst foot = css`\nmargin-left: auto;\n  margin-right: auto;\n  width: 80%;\n  max-width: 640px;\n  `\n\nconst cen = css`\n  text-align: center;\n`\n\nconst mar = css`\n  margin-top: 1rem;\n  margin-bottom: 0.5rem;\n`\n\nconst flex = css`\n\n\n    display: flex;\n    justify-content: space-between;\n\n`\n\nconst order_of_articles = [\n  \"/intro_to_probabilistic_linkage/\",\n  \"/maths_of_fellegi_sunter/\",\n  \"/visualising_fellegi_sunter/\",\n  \"/understanding_match_weights/\",\n  \"/match_weight_dependencies/\",\n  \"/m_u_generator/\",\n]\n\nconst LinkageFooter = (props) => {\n\n  let path = props.current_path\n\n  let this_index = order_of_articles.indexOf(path)\n\n  let previous_article = order_of_articles[this_index - 1]\n  let next_article = order_of_articles[this_index + 1]\n\n  if (previous_article === undefined) {\n    previous_article = <div></div>\n  } else {\n    previous_article = <div><Link to={previous_article}> &lt; Previous article</Link></div>\n  }\n\n  if (next_article === undefined) {\n    next_article = <div></div>\n  } else {\n    next_article = <div><Link to={next_article}> Next article &gt;</Link></div>\n  }\n\n  return (\n    <div>\n      <hr css={mar} />\n      <div css={flex}>\n        {previous_article}\n        <div><Link to=\"/probabilistic_linkage\">Probabilistic linkage home</Link></div>\n        {next_article}\n      </div>\n\n    </div >)\n}\n\nexport default LinkageFooter","import React from 'react'\nimport Layout from \"../layouts/layout\"\nimport LinkageFooter from './linkage_footer'\nimport ObeservableNotebookDiv from \"./observable_div\"\nimport PostFrontMatter from \"./post_frontmatter\"\nimport SEO from \"./seo\"\n\n\nfunction ProbLinkagePage(props) {\n\n\n  // let post\n\n\n  let post = <ObeservableNotebookDiv define={props.define} output_order={props.output_order} />\n\n\n  return (\n    <Layout css={props.className}>\n      <SEO title={props.post_frontmatter.title} description={props.post_frontmatter.description} />\n      <PostFrontMatter post_frontmatter={props.post_frontmatter} />\n      {post}\n      <LinkageFooter current_path={props.current_path}\n      />\n    </Layout>\n  )\n\n}\n\nexport default ProbLinkagePage","import _defineProperty from \"/home/runner/work/robinl.github.io/robinl.github.io/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _asyncToGenerator from \"/home/runner/work/robinl.github.io/robinl.github.io/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _taggedTemplateLiteral from \"/home/runner/work/robinl.github.io/robinl.github.io/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4, _templateObject5, _templateObject6, _templateObject7, _templateObject8, _templateObject9, _templateObject10, _templateObject11, _templateObject12, _templateObject13;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport _regeneratorRuntime from \"/home/runner/work/robinl.github.io/robinl.github.io/node_modules/@babel/runtime/regenerator\";\n// https://observablehq.com/@uwdata/arquero@209\nexport default function define(runtime, observer) {\n  var main = runtime.module();\n  main.variable(observer()).define([\"md\"], function (md) {\n    return md(_templateObject || (_templateObject = _taggedTemplateLiteral([\"# Arquero\\n\\nArquero is a library for query processing and transformation of array-backed data tables. Following the [relational algebra](https://en.wikipedia.org/wiki/Relational_algebra) and inspired by the design of [dplyr](https://dplyr.tidyverse.org/), Arquero provides a fluent API for manipulating column-oriented data frames. Arquero supports a range of data transformation tasks, including filter, sample, aggregation, window, join, and reshaping operations. Arquero is Spanish for \\\"archer\\\": if datasets are [arrows](https://observablehq.com/@theneuralbit/introduction-to-apache-arrow), Arquero helps their aim stay true.\"])));\n  });\n  main.variable(observer()).define([\"md\"], function (md) {\n    return md(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"Import Arquero and extend it to print HTML tables in Observable:\"])));\n  });\n  main.variable(observer(\"aq\")).define(\"aq\", [\"require\", \"aq_version\", \"aq_packages\", \"toView\"], /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(require, aq_version, aq_packages, toView) {\n      var aq;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return require(\"arquero@\".concat(aq_version));\n\n            case 2:\n              aq = _context.sent;\n              _context.next = 5;\n              return Promise.all(aq_packages.map(function (pkg) {\n                return require(pkg);\n              }));\n\n            case 5:\n              _context.sent.forEach(function (pkg) {\n                return aq.addPackage(pkg);\n              });\n\n              // Add HTML table view method to tables\n              aq.addTableMethod('view', toView, {\n                override: true\n              });\n              return _context.abrupt(\"return\", aq);\n\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x, _x2, _x3, _x4) {\n      return _ref.apply(this, arguments);\n    };\n  }());\n  main.variable(observer(\"aq_version\")).define(\"aq_version\", function () {\n    return '4.2.0';\n  });\n  main.variable(observer(\"aq_packages\")).define(\"aq_packages\", function () {\n    return [];\n  });\n  main.variable(observer()).define([\"md\"], function (md) {\n    return md(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"Export a global reference to Arquero operations:\"])));\n  });\n  main.variable(observer(\"op\")).define(\"op\", [\"aq\"], function (aq) {\n    return aq.op;\n  });\n  main.variable(observer()).define([\"md\"], function (md) {\n    return md(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"To use the same setup in your own notebooks, add a cell with the following code:\\n~~~ js\\nimport { aq, op } from '@uwdata/arquero'\\n~~~\\n\"])));\n  });\n  main.variable(observer()).define([\"md\"], function (md) {\n    return md(_templateObject5 || (_templateObject5 = _taggedTemplateLiteral([\"To get started, see the [Introducing Arquero](https://observablehq.com/@uwdata/introducing-arquero) and [Arquero Cookbook](https://observablehq.com/@uwdata/arquero-cookbook) notebooks.\"])));\n  });\n  main.variable(observer()).define([\"md\"], function (md) {\n    return md(_templateObject6 || (_templateObject6 = _taggedTemplateLiteral([\"To use Arquero outside of Observable, see [https://github.com/uwdata/arquero](https://github.com/uwdata/arquero).\"])));\n  });\n  main.variable(observer()).define([\"md\"], function (md) {\n    return md(_templateObject7 || (_templateObject7 = _taggedTemplateLiteral([\"<hr>\\n## Examples\\n\\nThe core abstractions in Arquero are *data tables*, which model each column as an array of values, and *verbs* that transform data and return new tables. Verbs are table methods, allowing method chaining for multi-step transformations. Though each table is unique, many verbs reuse the underlying columns to limit duplication.\\n\"])));\n  });\n  main.variable(observer()).define([\"md\"], function (md) {\n    return md(_templateObject8 || (_templateObject8 = _taggedTemplateLiteral([\"Average hours of sunshine per month, from [https://usclimatedata.com/](https://usclimatedata.com/):\"])));\n  });\n  main.variable(observer(\"dt\")).define(\"dt\", [\"aq\"], function (aq) {\n    return aq.table({\n      'Seattle': [69, 108, 178, 207, 253, 268, 312, 281, 221, 142, 72, 52],\n      'Chicago': [135, 136, 187, 215, 281, 311, 318, 283, 226, 193, 113, 106],\n      'San Francisco': [165, 182, 251, 281, 314, 330, 300, 272, 267, 243, 189, 156]\n    });\n  });\n  main.variable(observer()).define([\"md\"], function (md) {\n    return md(_templateObject9 || (_templateObject9 = _taggedTemplateLiteral([\"Sorted differences between Seattle and Chicago:\"])));\n  });\n  main.variable(observer()).define([\"dt\", \"op\"], function (dt, op) {\n    return dt.derive({\n      month: function month(d) {\n        return op.row_number();\n      },\n      diff: function diff(d) {\n        return d.Seattle - d.Chicago;\n      }\n    }).select('month', 'diff').orderby('month').view({\n      height: 400\n    });\n  });\n  main.variable(observer()).define([\"md\"], function (md) {\n    return md(_templateObject10 || (_templateObject10 = _taggedTemplateLiteral([\"Is Seattle more correlated with San Francisco or Chicago?\"])));\n  });\n  main.variable(observer()).define([\"dt\", \"op\"], function (dt, op) {\n    return dt.rollup({\n      corr_sf: op.corr('Seattle', 'San Francisco'),\n      corr_chi: op.corr('Seattle', 'Chicago')\n    }).view();\n  });\n  main.variable(observer()).define([\"md\"], function (md) {\n    return md(_templateObject11 || (_templateObject11 = _taggedTemplateLiteral([\"Summary statistics per city, as output objects:\"])));\n  });\n  main.variable(observer()).define([\"dt\", \"aq\", \"op\"], function (dt, aq, op) {\n    return dt.fold(aq.all(), {\n      as: ['city', 'sun']\n    }).groupby('city').rollup({\n      min: function min(d) {\n        return op.min(d.sun);\n      },\n      // functional form of op.min('sun')\n      max: function max(d) {\n        return op.max(d.sun);\n      },\n      avg: function avg(d) {\n        return op.average(d.sun);\n      },\n      med: function med(d) {\n        return op.median(d.sun);\n      },\n      // functional forms permit flexible table expressions\n      skew: function skew(_ref2) {\n        var s = _ref2.sun;\n        return (op.mean(s) - op.median(s)) / op.stdev(s) || 0;\n      }\n    }).objects();\n  });\n  main.variable(observer()).define([\"md\"], function (md) {\n    return md(_templateObject12 || (_templateObject12 = _taggedTemplateLiteral([\"<hr>\\n## Utilities\\n\"])));\n  });\n  main.variable(observer(\"toView\")).define(\"toView\", [\"html\"], function (html) {\n    var DEFAULT_LIMIT = 100;\n\n    var DEFAULT_NULL = function DEFAULT_NULL(value) {\n      return \"<span style=\\\"color: #999;\\\">\".concat(value, \"</span>\");\n    };\n\n    var tableStyle = 'margin: 0; border-collapse: collapse; width: initial;';\n    var cellStyle = 'padding: 1px 5px; white-space: nowrap; overflow-x: hidden; text-overflow: ellipsis; font-variant-numeric: tabular-nums;'; // extend table prototype to provide an HTML table view\n\n    return function (dt) {\n      var opt = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      // permit shorthand for limit\n      if (typeof opt === 'number') opt = {\n        limit: opt\n      }; // marshal cell color options\n\n      var color = _objectSpread({}, opt.color);\n\n      if (typeof opt.color === 'function') {\n        // if function, apply to all columns\n        dt.columnNames().forEach(function (name) {\n          return color[name] = opt.color;\n        });\n      } else {\n        var _loop = function _loop(key) {\n          var value = color[key];\n          color[key] = typeof value === 'function' ? value : function () {\n            return value;\n          };\n        };\n\n        // otherwise, gather per-column color options\n        for (var key in color) {\n          _loop(key);\n        }\n      } // marshal CSS styles as toHTML() options\n\n\n      var table = \"\".concat(tableStyle);\n\n      var td = function td(name, index, row) {\n        return \"\".concat(cellStyle, \" max-width: \").concat(+opt.maxCellWidth || 300, \"px;\") + (color[name] ? \" background-color: \".concat(color[name](index, row), \";\") : '');\n      };\n\n      opt = _objectSpread(_objectSpread({\n        limit: DEFAULT_LIMIT,\n        null: DEFAULT_NULL\n      }, opt), {}, {\n        style: {\n          table: table,\n          td: td,\n          th: td\n        }\n      }); // return container div, bind table value to support viewof operator\n\n      var size = \"max-height: \".concat(+opt.height || 270, \"px\");\n      var style = \"\".concat(size, \"; overflow-x: auto; overflow-y: auto;\");\n      var view = html(_templateObject13 || (_templateObject13 = _taggedTemplateLiteral([\"<div style=\\\"\", \"\\\">\", \"</div>\"])), style, dt.toHTML(opt));\n      view.value = dt;\n      return view;\n    };\n  });\n  return main;\n}","import _classCallCheck from \"/home/runner/work/robinl.github.io/robinl.github.io/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/runner/work/robinl.github.io/robinl.github.io/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _taggedTemplateLiteral from \"/home/runner/work/robinl.github.io/robinl.github.io/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _templateObject;\n\nimport define1 from \"./79750b3b8e929d9d@209.js\";\nexport default function define(runtime, observer) {\n  var main = runtime.module();\n  main.variable(observer()).define([\"md\"], function (md) {\n    return md(_templateObject || (_templateObject = _taggedTemplateLiteral([\"# Record Utilities\"])));\n  });\n  main.variable(observer(\"Record\")).define(\"Record\", [\"aq\"], function (aq) {\n    return /*#__PURE__*/function () {\n      function Record(record_dict) {\n        _classCallCheck(this, Record);\n\n        this.record_dict = record_dict;\n      }\n\n      _createClass(Record, [{\n        key: \"as_dict\",\n        value: function as_dict() {\n          return this.record_dict;\n        }\n      }, {\n        key: \"as_aq\",\n        value: function as_aq() {\n          return aq.from([this.record_dict]);\n        }\n      }, {\n        key: \"display\",\n        value: function display() {\n          return this.as_aq().view();\n        }\n      }]);\n\n      return Record;\n    }();\n  });\n  main.variable(observer(\"RecordComparison\")).define(\"RecordComparison\", [\"aq\"], function (aq) {\n    return /*#__PURE__*/function () {\n      function RecordComparison(record_l, record_r) {\n        _classCallCheck(this, RecordComparison);\n\n        this.record_l = record_l;\n        this.record_r = record_r;\n      }\n\n      _createClass(RecordComparison, [{\n        key: \"as_long\",\n        value: function as_long() {\n          var records = [this.record_l.as_dict(), this.record_r.as_dict()];\n          return aq.from(records);\n        }\n      }, {\n        key: \"as_wide\",\n        value: function as_wide() {\n          var t_l = this.record_l.as_aq();\n          var t_r = this.record_r.as_aq();\n          var comparison = t_l.join(t_r, function (a, b) {\n            return true;\n          }, null, {\n            suffix: [\"_l\", \"_r\"]\n          }); // Group columns\n\n          var colname_no_suffix = t_l.columnNames();\n          var cols_ordered = [];\n          colname_no_suffix.forEach(function (d) {\n            cols_ordered.push(d + \"_l\");\n            cols_ordered.push(d + \"_r\");\n          });\n          comparison = comparison.select(cols_ordered);\n          return comparison;\n        }\n      }, {\n        key: \"display\",\n        value: function display() {\n          var wide_or_long = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"long\";\n\n          if (wide_or_long == \"long\") {\n            return this.as_long().view();\n          } else if (wide_or_long == \"wide\") {\n            return this.as_wide().view();\n          }\n        }\n      }]);\n\n      return RecordComparison;\n    }();\n  });\n  var child1 = runtime.module(define1);\n  main.import(\"aq\", child1);\n  main.import(\"op\", child1);\n  return main;\n}","import _defineProperty from \"/home/runner/work/robinl.github.io/robinl.github.io/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _taggedTemplateLiteral from \"/home/runner/work/robinl.github.io/robinl.github.io/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nexport default function define(runtime, observer) {\n  var main = runtime.module();\n  main.variable(observer()).define([\"md\"], function (md) {\n    return md(_templateObject || (_templateObject = _taggedTemplateLiteral([\"# Waterfall chart\"])));\n  });\n  main.variable(observer()).define([\"md\"], function (md) {\n    return md(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"### Objective\\n\\nTake \\n- a Splink settings object \\n- A row of data from `df_e`\\nAnd turn it into the data needed for the waterfall chart.\\n\\n\"], [\"### Objective\\n\\nTake \\n- a Splink settings object \\n- A row of data from \\\\`df_e\\\\`\\nAnd turn it into the data needed for the waterfall chart.\\n\\n\"])));\n  });\n  main.variable(observer()).define([\"md\"], function (md) {\n    return md(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"## Example\"])));\n  });\n  main.variable(observer(\"splink_settings\")).define(\"splink_settings\", function () {\n    return {\n      proportion_of_matches: 1 / 100,\n      comparison_columns: [{\n        num_levels: 3,\n        col_name: \"first_name\",\n        u_probabilities: [0.8, 0.2],\n        m_probabilities: [0.2, 0.8]\n      }, {\n        num_levels: 3,\n        col_name: \"surname\",\n        u_probabilities: [0.8, 0.2],\n        m_probabilities: [0.2, 0.8]\n      }, {\n        col_name: \"date_of_birth\",\n        u_probabilities: [0.99, 0.01],\n        m_probabilities: [0.2, 0.8]\n      }]\n    };\n  });\n  main.variable(observer(\"row\")).define(\"row\", function () {\n    var _ref;\n\n    return _ref = {\n      first_name_l: \"John\",\n      first_name_r: \"John\",\n      \"\\uD835\\uDEFE_first_name\": 1,\n      surname_l: \"Smith\",\n      surname_r: \"Smith\",\n      \"\\uD835\\uDEFE_surname\": 1,\n      date_of_birth_l: \"1992-04-01\"\n    }, _defineProperty(_ref, \"date_of_birth_l\", \"1992-04-02\"), _defineProperty(_ref, \"\\uD835\\uDEFE_date_of_birth\", 0), _defineProperty(_ref, \"other\", \"hi\"), _ref;\n  });\n  main.variable(observer(\"overrides\")).define(\"overrides\", function () {\n    return {\n      height: 200\n    };\n  });\n  main.variable(observer()).define([\"get_waterfall_chart\", \"row\", \"splink_settings\", \"overrides\"], function (get_waterfall_chart, row, splink_settings, overrides) {\n    return get_waterfall_chart(row, splink_settings, overrides, true);\n  });\n  main.variable(observer()).define([\"get_waterfall_chart\", \"row\", \"splink_settings\", \"overrides\"], function (get_waterfall_chart, row, splink_settings, overrides) {\n    return get_waterfall_chart(row, splink_settings, overrides, false);\n  });\n  main.variable(observer()).define([\"md\"], function (md) {\n    return md(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"## Code\"])));\n  });\n  main.variable(observer(\"get_waterfall_chart\")).define(\"get_waterfall_chart\", [\"get_waterfall_chart_data\", \"embed\", \"get_chart_spec\"], function (get_waterfall_chart_data, embed, get_chart_spec) {\n    return function (row, splink_settings, chart_overrides, simplified) {\n      var term_freqs = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n      var data = get_waterfall_chart_data(row, splink_settings, term_freqs);\n      return embed(get_chart_spec(data, chart_overrides, simplified));\n    };\n  });\n  main.variable(observer(\"get_comparison_column_lookup\")).define(\"get_comparison_column_lookup\", function () {\n    return function get_comparison_column_lookup(splink_settings) {\n      var lookup = {};\n      splink_settings.comparison_columns.forEach(function (d) {\n        var col_name = d[\"col_name\"];\n        lookup[col_name] = d;\n      });\n      return lookup;\n    };\n  });\n  main.variable(observer(\"get_waterfall_chart_data\")).define(\"get_waterfall_chart_data\", [\"get_waterfall_data_lambda_row\", \"get_waterfall_data_other_rows\", \"get_waterfall_data_final_row\"], function (get_waterfall_data_lambda_row, get_waterfall_data_other_rows, get_waterfall_data_final_row) {\n    return function get_waterfall_chart_data(row, splink_settings) {\n      var term_freqs = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var lambda_row = get_waterfall_data_lambda_row(splink_settings);\n      var waterfall_data_other_rows = get_waterfall_data_other_rows(row, splink_settings, term_freqs);\n      var rows_except_final = [lambda_row].concat(waterfall_data_other_rows);\n      var final_row = get_waterfall_data_final_row(splink_settings);\n      var cumulative_log2_bayes_factor = rows_except_final.reduce(function (a, b) {\n        return a + b[\"log2_bayes_factor\"];\n      }, 0);\n      final_row[\"bayes_factor\"] = Math.pow(2, cumulative_log2_bayes_factor);\n      final_row[\"log2_bayes_factor\"] = cumulative_log2_bayes_factor;\n      return rows_except_final.concat([final_row]);\n    };\n  });\n  main.variable(observer(\"get_waterfall_row_gamma\")).define(\"get_waterfall_row_gamma\", [\"get_comparison_column_lookup\", \"log2\"], function (get_comparison_column_lookup, log2) {\n    return function get_waterfall_row_gamma(gamma_key, row, splink_settings, term_freqs) {\n      var key = gamma_key;\n      var gamma_value = row[key];\n      var col_name = key.replace(\"𝛾_\", \"\");\n      var cc_lookup = get_comparison_column_lookup(splink_settings);\n      var this_cc = cc_lookup[col_name];\n      var value_l = row[col_name + \"_l\"];\n      var value_r = row[col_name + \"_r\"];\n      var u_probability, m_probability;\n\n      if (gamma_value == -1) {\n        u_probability = 0.5;\n        m_probability = 0.5;\n      } else {\n        u_probability = this_cc[\"u_probabilities\"][gamma_value];\n        m_probability = this_cc[\"m_probabilities\"][gamma_value];\n\n        if (value_l == value_r) {\n          if (col_name in term_freqs) {\n            var tfs = term_freqs[col_name];\n            u_probability = tfs[value_l] || u_probability;\n          }\n        }\n      }\n\n      var bayes_factor = m_probability / u_probability;\n      return {\n        bayes_factor: bayes_factor,\n        column_name: col_name,\n        gamma_column_name: \"𝛾_\" + col_name,\n        gamma_index: gamma_value,\n        level_name: \"level_\" + gamma_value,\n        log2_bayes_factor: log2(bayes_factor),\n        m_probability: m_probability,\n        num_levels: null,\n        u_probability: u_probability,\n        value_l: value_l,\n        value_r: value_r\n      };\n    };\n  });\n  main.variable(observer(\"get_waterfall_data_lambda_row\")).define(\"get_waterfall_data_lambda_row\", [\"prob_to_bayes_factor\", \"prob_to_log2_bayes_factor\"], function (prob_to_bayes_factor, prob_to_log2_bayes_factor) {\n    return function (splink_settings) {\n      var row = {\n        bayes_factor: prob_to_bayes_factor(splink_settings.proportion_of_matches),\n        column_name: \"Prior\",\n        gamma_column_name: \"\",\n        gamma_index: \"\",\n        level_name: null,\n        log2_bayes_factor: prob_to_log2_bayes_factor(splink_settings.proportion_of_matches),\n        m_probability: null,\n        num_levels: null,\n        u_probability: null,\n        value_l: \"\",\n        value_r: \"\"\n      };\n      return row;\n    };\n  });\n  main.variable(observer(\"get_waterfall_data_other_rows\")).define(\"get_waterfall_data_other_rows\", [\"get_waterfall_row_gamma\"], function (get_waterfall_row_gamma) {\n    return function (row, splink_settings, term_freqs) {\n      var keys = Object.keys(row);\n      keys = keys.filter(function (key) {\n        return key.includes(\"𝛾_\");\n      });\n      return keys.map(function (gamma_key) {\n        return get_waterfall_row_gamma(gamma_key, row, splink_settings, term_freqs);\n      });\n    };\n  });\n  main.variable(observer(\"get_waterfall_data_final_row\")).define(\"get_waterfall_data_final_row\", function () {\n    return function (splink_settings) {\n      var row = {\n        bayes_factor: null,\n        column_name: \"Final score\",\n        gamma_column_name: \"\",\n        gamma_index: \"\",\n        level_name: null,\n        log2_bayes_factor: null,\n        m_probability: null,\n        num_levels: null,\n        u_probability: null,\n        value_l: \"\",\n        value_r: \"\"\n      };\n      return row;\n    };\n  });\n  main.variable(observer(\"get_chart_spec\")).define(\"get_chart_spec\", [\"base_spec\"], function (base_spec) {\n    return function (data, overrides) {\n      var simplified = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var base_spec_2 = JSON.parse(JSON.stringify(base_spec)); // let base_spec_2 = Object.assign({}, base_spec);\n\n      base_spec_2.data.values = data;\n\n      var spec = _objectSpread(_objectSpread({}, base_spec_2), overrides);\n\n      if (simplified) {\n        // Remove right hand axis\n        spec[\"layer\"][1][\"encoding\"][\"y\"][\"axis\"] = false; // Remove bayes factor text overlays\n        // spec[\"layer\"][0][\"layer\"].splice(2, 1);\n\n        spec[\"layer\"][0][\"layer\"][2][\"encoding\"][\"text\"] = {\n          type: \"nominal\",\n          field: \"up_down_emoji\"\n        };\n        spec[\"layer\"][0][\"layer\"][2][\"encoding\"][\"opacity\"] = {\n          condition: {\n            value: 0,\n            test: \"datum.column_name == 'Final score' || datum.column_name == 'Prior'\"\n          }\n        }; // Make left hand side axis probability\n\n        var expr = \"format(1 / (1 + pow(2, -1*datum.value)), '.2r')\";\n        spec[\"layer\"][0][\"layer\"][1][\"encoding\"][\"y\"][\"axis\"][\"labelExpr\"] = expr;\n        spec[\"layer\"][0][\"layer\"][1][\"encoding\"][\"y\"][\"axis\"][\"title\"] = \"probability\"; // Tooltip\n\n        spec[\"layer\"][0][\"layer\"][1][\"encoding\"][\"tooltip\"] = [{\n          type: \"quantitative\",\n          field: \"prob\",\n          format: \".3r\",\n          title: \"Cumulative match probability\"\n        }];\n      }\n\n      return spec;\n    };\n  });\n  main.variable(observer(\"base_spec\")).define(\"base_spec\", function () {\n    return {\n      config: {\n        view: {\n          continuousHeight: 300,\n          continuousWidth: 400\n        }\n      },\n      title: {\n        text: \"Bayes factor intuition chart\",\n        subtitle: \"How each comparison column contributes to the final match score\"\n      },\n      transform: [{\n        filter: \"(datum.bayes_factor !== 1.0)\"\n      }, {\n        window: [{\n          op: \"sum\",\n          field: \"log2_bayes_factor\",\n          as: \"sum\"\n        }, {\n          op: \"lead\",\n          field: \"column_name\",\n          as: \"lead\"\n        }],\n        frame: [null, 0]\n      }, {\n        calculate: 'datum.column_name === \"Final score\" ? datum.sum - datum.log2_bayes_factor : datum.sum',\n        as: \"sum\"\n      }, {\n        calculate: \"datum.lead === null ? datum.column_name : datum.lead\",\n        as: \"lead\"\n      }, {\n        calculate: 'datum.column_name === \"Final score\" || datum.column_name === \"Prior lambda\" ? 0 : datum.sum - datum.log2_bayes_factor',\n        as: \"previous_sum\"\n      }, {\n        calculate: 'datum.sum > datum.previous_sum ? datum.column_name : \"\"',\n        as: \"top_label\"\n      }, {\n        calculate: 'datum.sum < datum.previous_sum ? datum.column_name : \"\"',\n        as: \"bottom_label\"\n      }, {\n        calculate: \"datum.sum > datum.previous_sum ? datum.sum : datum.previous_sum\",\n        as: \"sum_top\"\n      }, {\n        calculate: \"datum.sum < datum.previous_sum ? datum.sum : datum.previous_sum\",\n        as: \"sum_bottom\"\n      }, {\n        calculate: \"(datum.sum + datum.previous_sum) / 2\",\n        as: \"center\"\n      }, {\n        calculate: '(datum.log2_bayes_factor > 0 ? \"+\" : \"\") + datum.log2_bayes_factor',\n        as: \"text_log2_bayes_factor\"\n      }, {\n        calculate: \"datum.sum < datum.previous_sum ? 4 : -4\",\n        as: \"dy\"\n      }, {\n        calculate: 'datum.sum < datum.previous_sum ? \"top\" : \"bottom\"',\n        as: \"baseline\"\n      }, {\n        calculate: \"1. / (1 + pow(2, -1.*datum.sum))\",\n        as: \"prob\"\n      }, {\n        calculate: \"0*datum.sum\",\n        as: \"zero\"\n      }, {\n        calculate: 'datum.sum > datum.previous_sum ? \"↑\" : \"↓\"',\n        as: \"up_down_emoji\"\n      }],\n      layer: [{\n        layer: [{\n          mark: \"rule\",\n          encoding: {\n            y: {\n              field: \"zero\",\n              type: \"quantitative\"\n            },\n            size: {\n              value: 0.5\n            },\n            color: {\n              value: \"black\"\n            }\n          }\n        }, {\n          mark: {\n            type: \"bar\",\n            width: 60\n          },\n          encoding: {\n            color: {\n              condition: {\n                value: \"red\",\n                test: \"(datum.log2_bayes_factor < 0)\"\n              },\n              value: \"green\"\n            },\n            opacity: {\n              condition: {\n                value: 1,\n                test: \"datum.column_name == 'Prior' || datum.column_name == 'Final score'\"\n              },\n              value: 0.5\n            },\n            tooltip: [{\n              type: \"nominal\",\n              field: \"column_name\",\n              title: \"Comparison column\"\n            }, {\n              type: \"nominal\",\n              field: \"value_l\",\n              title: \"Value (L)\"\n            }, {\n              type: \"nominal\",\n              field: \"value_r\",\n              title: \"Value (R)\"\n            }, {\n              type: \"nominal\",\n              field: \"gamma_index\",\n              title: \"Gamma level\"\n            }, {\n              type: \"quantitative\",\n              field: \"bayes_factor\",\n              format: \".3r\",\n              title: \"Bayes factor\"\n            }, {\n              type: \"quantitative\",\n              field: \"log2_bayes_factor\",\n              format: \".3r\",\n              title: \"log2(Bayes factor)\"\n            }, {\n              type: \"quantitative\",\n              field: \"prob\",\n              format: \".3r\",\n              title: \"Cumulative match probability\"\n            }],\n            x: {\n              type: \"nominal\",\n              axis: {\n                labelExpr: \"datum.value == 'Prior' || datum.value == 'Final score' ? '' : datum.value\",\n                labelAlign: \"center\",\n                labelPadding: 10,\n                title: \"Column\",\n                grid: true,\n                tickBand: \"extent\"\n              },\n              field: \"column_name\",\n              sort: null\n            },\n            y: {\n              type: \"quantitative\",\n              axis: {\n                grid: false,\n                orient: \"left\",\n                title: \"log2(Bayes factor)\"\n              },\n              field: \"previous_sum\"\n            },\n            y2: {\n              field: \"sum\"\n            }\n          }\n        }, {\n          mark: {\n            type: \"text\",\n            fontWeight: \"bold\"\n          },\n          encoding: {\n            color: {\n              value: \"white\"\n            },\n            text: {\n              condition: {\n                type: \"nominal\",\n                field: \"log2_bayes_factor\",\n                format: \".2f\",\n                test: \"abs(datum.log2_bayes_factor) > 1\"\n              },\n              value: \"\"\n            },\n            x: {\n              type: \"nominal\",\n              axis: {\n                labelAngle: 0,\n                title: \"Column\"\n              },\n              field: \"column_name\",\n              sort: null\n            },\n            y: {\n              type: \"quantitative\",\n              axis: {\n                orient: \"left\"\n              },\n              field: \"center\"\n            }\n          }\n        }, {\n          mark: {\n            type: \"text\",\n            baseline: \"bottom\",\n            dy: -5,\n            fontWeight: \"bold\"\n          },\n          encoding: {\n            color: {\n              value: \"black\"\n            },\n            text: {\n              condition: {\n                type: \"nominal\",\n                field: \"top_label\",\n                test: \"abs(datum.log2_bayes_factor) > 1\"\n              },\n              value: \"\"\n            },\n            x: {\n              type: \"nominal\",\n              axis: {\n                labelAngle: 0,\n                title: \"Column\"\n              },\n              field: \"column_name\",\n              sort: null\n            },\n            y: {\n              type: \"quantitative\",\n              field: \"sum_top\"\n            }\n          }\n        }, {\n          mark: {\n            type: \"text\",\n            baseline: \"top\",\n            dy: 5,\n            fontWeight: \"bold\"\n          },\n          encoding: {\n            color: {\n              value: \"black\"\n            },\n            text: {\n              condition: {\n                type: \"nominal\",\n                field: \"bottom_label\",\n                test: \"abs(datum.log2_bayes_factor) > 1\"\n              },\n              value: \"\"\n            },\n            x: {\n              type: \"nominal\",\n              axis: {\n                labelAngle: 0,\n                title: \"Column\"\n              },\n              field: \"column_name\",\n              sort: null\n            },\n            y: {\n              type: \"quantitative\",\n              field: \"sum_bottom\"\n            }\n          }\n        }]\n      }, {\n        mark: {\n          type: \"rule\",\n          color: \"black\",\n          strokeWidth: 2,\n          x2Offset: 30,\n          xOffset: -30\n        },\n        encoding: {\n          x: {\n            type: \"nominal\",\n            axis: {\n              labelAngle: 0,\n              title: \"Column\"\n            },\n            field: \"column_name\",\n            sort: null\n          },\n          x2: {\n            field: \"lead\"\n          },\n          y: {\n            type: \"quantitative\",\n            axis: {\n              labelExpr: \"format(1 / (1 + pow(2, -1*datum.value)), '.2r')\",\n              orient: \"right\",\n              title: \"Probability\"\n            },\n            field: \"sum\",\n            scale: {\n              zero: false\n            }\n          }\n        }\n      }],\n      height: 450,\n      resolve: {\n        axis: {\n          y: \"independent\"\n        }\n      },\n      width: {\n        step: 75\n      },\n      $schema: \"https://vega.github.io/schema/vega-lite/v4.8.1.json\",\n      data: {\n        values: null\n      }\n    };\n  });\n  main.variable(observer(\"embed\")).define(\"embed\", [\"require\"], function (require) {\n    return require(\"vega-embed@6\");\n  });\n  main.variable(observer(\"bayes_factor_to_prob\")).define(\"bayes_factor_to_prob\", function () {\n    return function bayes_factor_to_prob(b) {\n      return b / (b + 1);\n    };\n  });\n  main.variable(observer(\"log2\")).define(\"log2\", function () {\n    return Math.log2;\n  });\n  main.variable(observer(\"prob_to_bayes_factor\")).define(\"prob_to_bayes_factor\", function () {\n    return function prob_to_bayes_factor(p) {\n      return p / (1 - p);\n    };\n  });\n  main.variable(observer(\"prob_to_log2_bayes_factor\")).define(\"prob_to_log2_bayes_factor\", [\"log2\", \"prob_to_bayes_factor\"], function (log2, prob_to_bayes_factor) {\n    return function prob_to_log2_bayes_factor(p) {\n      return log2(prob_to_bayes_factor(p));\n    };\n  });\n  main.variable(observer(\"log2_bayes_factor_to_prob\")).define(\"log2_bayes_factor_to_prob\", [\"bayes_factor_to_prob\"], function (bayes_factor_to_prob) {\n    return function log2_bayes_factor_to_prob(log2_b) {\n      return bayes_factor_to_prob(Math.pow(2, log2_b));\n    };\n  });\n  main.variable(observer(\"first_name_lookup\")).define(\"first_name_lookup\", [\"d3\"], function (d3) {\n    return d3.csv(\"https://gist.githubusercontent.com/RobinL/0ee2e59db8cbecc105942fe4b101e847/raw/110e5bb3b574b7584b5452d4accfcfad71f2b19d/first_name_noyear.csv\", d3.autoType).then(function (csv_file) {\n      var lookup = {};\n      csv_file.forEach(function (row) {\n        lookup[row.firstname] = row.freq;\n      });\n      return lookup;\n    });\n  });\n  main.variable(observer(\"term_freqs\")).define(\"term_freqs\", [\"first_name_lookup\"], function (first_name_lookup) {\n    return {\n      first_name: first_name_lookup\n    };\n  });\n  return main;\n}","import _taggedTemplateLiteral from \"/home/runner/work/robinl.github.io/robinl.github.io/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4, _templateObject5;\n\nimport define1 from \"./79750b3b8e929d9d@209.js\";\nexport default function define(runtime, observer) {\n  var main = runtime.module();\n  main.variable(observer()).define([\"md\"], function (md) {\n    return md(_templateObject || (_templateObject = _taggedTemplateLiteral([\"# Fellegi Sunter utils\"])));\n  });\n  main.variable(observer(\"records_l\")).define(\"records_l\", function () {\n    return [{\n      uid: \"1_l\",\n      fname: \"John\",\n      sname: \"Smith\",\n      dob: \"1989-03-02\",\n      town: \"Bristol\"\n    }, {\n      uid: \"2_l\",\n      fname: \"Tom\",\n      sname: \"Hanks\",\n      dob: \"1956-07-09\",\n      town: \"Concord\"\n    }, {\n      uid: \"3_l\",\n      fname: \"David\",\n      sname: \"Smith\",\n      dob: \"1981-08-21\",\n      town: \"London\"\n    }];\n  });\n  main.variable(observer(\"records_r\")).define(\"records_r\", function () {\n    return [{\n      uid: \"1_r\",\n      fname: \"Jonathan\",\n      sname: \"Smith\",\n      dob: \"1989-03-02\",\n      town: \"Bristol\"\n    }, {\n      uid: \"2_r\",\n      fname: \"David\",\n      sname: \"Smith\",\n      dob: \"1981-08-21\",\n      town: \"Peckham\"\n    }];\n  });\n  main.variable(observer(\"df_r\")).define(\"df_r\", [\"aq\", \"records_r\"], function (aq, records_r) {\n    return aq.from(records_r);\n  });\n  main.variable(observer(\"splink_settings\")).define(\"splink_settings\", function () {\n    return {\n      proportion_of_matches: 1 / 100,\n      comparison_columns: [{\n        num_levels: 3,\n        col_name: \"fname\",\n        u_probabilities: [0.8, 0.2],\n        m_probabilities: [0.2, 0.8],\n        case_expression: function case_expression(row) {\n          if (row.fname_l == row.fname_r) {\n            return 1;\n          } else {\n            return 0;\n          }\n        }\n      }, {\n        num_levels: 3,\n        col_name: \"sname\",\n        u_probabilities: [0.9, 0.1],\n        m_probabilities: [0.2, 0.8],\n        case_expression: function case_expression(row) {\n          if (row.sname_l == row.sname_r) {\n            return 1;\n          } else {\n            return 0;\n          }\n        }\n      }, {\n        col_name: \"dob\",\n        u_probabilities: [0.99, 0.01],\n        m_probabilities: [0.2, 0.8],\n        case_expression: function case_expression(row) {\n          if (row.dob_l == row.dob_r) {\n            return 1;\n          } else {\n            return 0;\n          }\n        }\n      }, {\n        col_name: \"town\",\n        u_probabilities: [0.7, 0.3],\n        m_probabilities: [0.3, 0.7],\n        case_expression: function case_expression(row) {\n          if (row.town_l == row.town_r) {\n            return 1;\n          } else {\n            return 0;\n          }\n        }\n      }]\n    };\n  });\n  main.variable(observer(\"df_comparison\")).define(\"df_comparison\", [\"get_df_comparison\", \"records_l\", \"records_r\"], function (get_df_comparison, records_l, records_r) {\n    return get_df_comparison(records_l, records_r);\n  });\n  main.variable(observer()).define([\"df_comparison\"], function (df_comparison) {\n    return df_comparison.view();\n  });\n  main.variable(observer(\"df_gammas\")).define(\"df_gammas\", [\"get_df_gammas\", \"df_comparison\", \"splink_settings\"], function (get_df_gammas, df_comparison, splink_settings) {\n    return get_df_gammas(df_comparison, splink_settings);\n  });\n  main.variable(observer()).define([\"df_gammas\"], function (df_gammas) {\n    return df_gammas.view();\n  });\n  main.variable(observer()).define([\"get_df_e\", \"df_gammas\", \"splink_settings\", \"term_freqs\"], function (get_df_e, df_gammas, splink_settings, term_freqs) {\n    return get_df_e(df_gammas, splink_settings, term_freqs).view();\n  });\n  main.variable(observer(\"get_df_e\")).define(\"get_df_e\", [\"get_match_probability\", \"aq\"], function (get_match_probability, aq) {\n    return function get_df_e(df_gammas, splink_settings) {\n      var term_freqs = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var df_e = df_gammas.objects().map(function (row) {\n        row[\"match_probability\"] = get_match_probability(row, splink_settings, term_freqs);\n        return row;\n      });\n      var df = aq.from(df_e);\n      df = df.relocate([\"match_probability\"], {\n        after: \"uid_r\"\n      });\n      return df;\n    };\n  });\n  main.variable(observer(\"get_match_probability\")).define(\"get_match_probability\", [\"prob_to_log2_bf\", \"log2_bf_to_prob\"], function (prob_to_log2_bf, log2_bf_to_prob) {\n    return function (row, settings) {\n      var term_freqs = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var comparison_columns = settings.comparison_columns;\n      var prior_log2_bg = prob_to_log2_bf(settings.proportion_of_matches);\n      var log2_bayes = comparison_columns.reduce(function (a, cc) {\n        var gamma_col_name = \"𝛾_\" + cc.col_name;\n        var gamma = row[gamma_col_name]; // gamma = -1 means one side of the comparison is null\n\n        if (gamma == -1) {\n          return a;\n        }\n\n        var m = cc[\"m_probabilities\"][gamma];\n        var u = cc[\"u_probabilities\"][gamma]; // If TF lookup provided, attempt to use to overwrite u\n\n        var l_val = row[cc.col_name + \"_l\"].toLowerCase();\n        var r_val = row[cc.col_name + \"_r\"].toLowerCase();\n\n        if (l_val == r_val) {\n          if (cc.col_name in term_freqs) {\n            var tfs = term_freqs[cc.col_name];\n            var u_l = tfs[l_val] || 0;\n            var u_r = tfs[r_val] || 0;\n            var u_new = Math.max(u_l, u_r);\n\n            if (u_new > 0) {\n              u = u_new;\n            }\n          }\n        }\n\n        return a + Math.log2(m / u);\n      }, prior_log2_bg);\n      return log2_bf_to_prob(log2_bayes);\n    };\n  });\n  main.variable(observer(\"get_match_probability_components\")).define(\"get_match_probability_components\", [\"prob_to_log2_bf\", \"log2_bf_to_prob\"], function (prob_to_log2_bf, log2_bf_to_prob) {\n    return function (row, settings, num_columns) {\n      if (num_columns == undefined) {\n        num_columns = settings.comparison_columns.length;\n      }\n\n      var comparison_columns = settings.comparison_columns.slice(0, num_columns);\n      var prior_log2_bg = prob_to_log2_bf(settings.proportion_of_matches);\n      var d = {\n        comparison_vector: [],\n        gamma_symbols: [],\n        m_values: [],\n        u_values: [],\n        m_symbols: [],\n        u_symbols: [],\n        bayes_factors: [],\n        log2_bayes_factors: [],\n        col_names: [],\n        match_probability: null,\n        lam: settings.proportion_of_matches\n      };\n      comparison_columns.forEach(function (cc) {\n        var col_name = \"𝛾_\" + cc.col_name;\n        var gamma = row[col_name];\n        var m = cc[\"m_probabilities\"][gamma];\n        var u = cc[\"u_probabilities\"][gamma];\n        var col_name_escaped = cc.col_name.replace(\"_\", \"\\\\_\");\n        d[\"comparison_vector\"].push(gamma);\n        d[\"gamma_symbols\"].push(\"\\\\gamma_\\\\text{\".concat(col_name_escaped, \"}\"));\n        d[\"col_names\"].push(col_name);\n        d[\"m_values\"].push(m);\n        d[\"m_symbols\"].push(\"m_{\\\\text{\".concat(col_name_escaped, \"},\").concat(gamma, \"}\"));\n        d[\"u_values\"].push(u);\n        d[\"u_symbols\"].push(\"u_{\\\\text{\".concat(col_name_escaped, \"},\").concat(gamma, \"}\"));\n        d[\"bayes_factors\"].push(m / u);\n        d[\"log2_bayes_factors\"].push(Math.log2(m / u));\n      });\n      var log2_bayes = d[\"log2_bayes_factors\"].reduce(function (a, bf) {\n        return a + bf;\n      }, prior_log2_bg);\n      d[\"match_probability\"] = log2_bf_to_prob(log2_bayes);\n      var lam = settings.proportion_of_matches;\n      d[\"size_of_match_portion\"] = lam * d[\"m_values\"].reduce(function (a, b) {\n        return a * b;\n      }, 1);\n      d[\"size_of_non_match_portion\"] = (1 - lam) * d[\"u_values\"].reduce(function (a, b) {\n        return a * b;\n      }, 1);\n      return d;\n    };\n  });\n  main.variable(observer(\"get_m_u_formula_numbers\")).define(\"get_m_u_formula_numbers\", [\"get_match_probability_components\"], function (get_match_probability_components) {\n    return function (row, settings, num_columns) {\n      var d = get_match_probability_components(row, settings, num_columns);\n      var m = d[\"m_values\"].map(function (d) {\n        return d.toPrecision(3);\n      });\n      var u = d[\"u_values\"].map(function (d) {\n        return d.toPrecision(3);\n      });\n      var lam = d[\"lam\"].toPrecision(3);\n      var lam_m = [lam].concat(m);\n      var lam_u = [\"(1 - \".concat(lam, \")\")].concat(u);\n      var m_tex = lam_m.join(\" \\\\times \");\n      var u_tex = lam_u.join(\" \\\\times \");\n      var p = d[\"match_probability\"].toPrecision(3);\n      var m_part = d[\"size_of_match_portion\"].toPrecision(3);\n      var u_part = d[\"size_of_non_match_portion\"].toPrecision(3);\n      return \"\\\\frac{\".concat(m_tex, \"}{(\").concat(m_tex, \") + (\").concat(u_tex, \")}  \\\\newline[10pt] = \\\\frac{\").concat(m_part, \"}{\").concat(m_part, \" + \").concat(u_part, \"}  \\\\newline[10pt] = \").concat(p);\n    };\n  });\n  main.variable(observer(\"get_m_u_formula_symbols\")).define(\"get_m_u_formula_symbols\", [\"get_match_probability_components\"], function (get_match_probability_components) {\n    return function (row, settings) {\n      var d = get_match_probability_components(row, settings);\n      var m = d[\"m_symbols\"];\n      var u = d[\"u_symbols\"];\n      var lam = d[\"lam\"];\n      var lam_m = [\"\\\\lambda\"].concat(m);\n      var lam_u = [\"(1 - \\\\lambda)\"].concat(u);\n      var m_tex = lam_m.join(\" \");\n      var u_tex = lam_u.join(\" \");\n      return \"\\\\frac{\".concat(m_tex, \"}{\").concat(m_tex, \") + \").concat(u_tex, \"}\");\n    };\n  });\n  main.variable(observer()).define([\"tex\", \"get_m_u_formula_symbols\", \"df_gammas\", \"splink_settings\"], function (tex, get_m_u_formula_symbols, df_gammas, splink_settings) {\n    return tex(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\", \"\\n\"])), get_m_u_formula_symbols(df_gammas.objects()[0], splink_settings));\n  });\n  main.variable(observer(\"get_comparison_vector_symbols_and_numbers\")).define(\"get_comparison_vector_symbols_and_numbers\", [\"get_match_probability_components\"], function (get_match_probability_components) {\n    return function (row, settings, num_columns) {\n      var d = get_match_probability_components(row, settings, num_columns);\n      var joined = d[\"gamma_symbols\"].join(\", \");\n      var joined2 = d[\"comparison_vector\"].join(\", \");\n      return \"\\\\bm{\\\\gamma} = [\".concat(joined, \"]= [\").concat(joined2, \"]\");\n    };\n  });\n  main.variable(observer()).define([\"tex\", \"get_comparison_vector_symbols_and_numbers\", \"df_gammas\", \"splink_settings\"], function (tex, get_comparison_vector_symbols_and_numbers, df_gammas, splink_settings) {\n    return tex(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"\", \"\\n\"])), get_comparison_vector_symbols_and_numbers(df_gammas.objects()[0], splink_settings));\n  });\n  main.variable(observer()).define([\"tex\"], function (tex) {\n    return tex(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"\\bm{gamma} = [gamma_\\text{fname}, gamma_\\text{sname}]\"], [\"\\\\bm{\\\\gamma} = [\\\\gamma_\\\\text{fname}, \\\\gamma_\\\\text{sname}]\"])));\n  });\n  main.variable(observer()).define([\"tex\", \"get_m_u_formula_numbers\", \"df_gammas\", \"splink_settings\"], function (tex, get_m_u_formula_numbers, df_gammas, splink_settings) {\n    return tex(_templateObject5 || (_templateObject5 = _taggedTemplateLiteral([\"\", \"\"])), get_m_u_formula_numbers(df_gammas.objects()[0], splink_settings));\n  });\n  main.variable(observer()).define([\"get_match_probability_components\", \"df_gammas\", \"splink_settings\"], function (get_match_probability_components, df_gammas, splink_settings) {\n    return get_match_probability_components(df_gammas.objects()[0], splink_settings);\n  });\n  main.variable(observer(\"get_df_comparison\")).define(\"get_df_comparison\", [\"aq\"], function (aq) {\n    return function (records_as_dict_l, records_as_dict_r) {\n      var df_l = aq.from(records_as_dict_l);\n      var df_r = aq.from(records_as_dict_r);\n      var df_comparison = df_l.join(df_r, function (a, b) {\n        return true;\n      }, null, {\n        suffix: [\"_l\", \"_r\"]\n      }); // Group columns\n\n      var colname_no_suffix = df_l.columnNames();\n      var cols_ordered = [];\n      colname_no_suffix.forEach(function (d) {\n        cols_ordered.push(d + \"_l\");\n        cols_ordered.push(d + \"_r\");\n      });\n      df_comparison = df_comparison.select(cols_ordered);\n      return df_comparison;\n    };\n  });\n  main.variable(observer(\"get_df_gammas\")).define(\"get_df_gammas\", [\"aq\"], function (aq) {\n    return function get_df_gammas(df_comparison, splink_settings) {\n      var comparison_columns = splink_settings[\"comparison_columns\"]; // let df_gammas = df_comparison;\n      // let derivation = {};\n      // comparison_columns.forEach(function (cc) {\n      //   derivation[\"𝛾_\" + cc.col_name] = cc.case_expression;\n      // });\n      // df_gammas = df_gammas.derive(derivation);\n      // Since we want function calls like double metaphone in our comparison columns, we need to\n      // roundtrip from aq -> object -> aq\n\n      var df_gammas = df_comparison.objects();\n      comparison_columns.forEach(function (cc) {\n        df_gammas.forEach(function (row) {\n          row[\"𝛾_\" + cc.col_name] = cc.case_expression(row);\n        });\n      });\n      df_gammas = aq.from(df_gammas); // Put columns in order\n\n      var col_order = [\"uid_l\", \"uid_r\"];\n      comparison_columns.forEach(function (cc) {\n        col_order.push(cc.col_name + \"_l\");\n        col_order.push(cc.col_name + \"_r\");\n        col_order.push(\"𝛾_\" + cc.col_name);\n      });\n      df_gammas = df_gammas.select(col_order);\n      return df_gammas;\n    };\n  });\n  main.variable(observer(\"bayes_factor_to_prob\")).define(\"bayes_factor_to_prob\", function () {\n    return function bayes_factor_to_prob(b) {\n      return b / (b + 1);\n    };\n  });\n  main.variable(observer(\"log2_bf_to_prob\")).define(\"log2_bf_to_prob\", [\"bayes_factor_to_prob\"], function (bayes_factor_to_prob) {\n    return function log2_bf_to_prob(b) {\n      return bayes_factor_to_prob(Math.pow(2, b));\n    };\n  });\n  main.variable(observer(\"prob_to_bayes_factor\")).define(\"prob_to_bayes_factor\", function () {\n    return function prob_to_bayes_factor(p) {\n      return p / (1 - p);\n    };\n  });\n  main.variable(observer(\"prob_to_log2_bf\")).define(\"prob_to_log2_bf\", [\"prob_to_bayes_factor\"], function (prob_to_bayes_factor) {\n    return function prob_to_log2_bf(p) {\n      return Math.log2(prob_to_bayes_factor(p));\n    };\n  });\n  var child1 = runtime.module(define1);\n  main.import(\"aq\", child1);\n  main.import(\"op\", child1);\n  main.variable(observer(\"first_name_lookup\")).define(\"first_name_lookup\", [\"d3\"], function (d3) {\n    return d3.csv(\"https://gist.githubusercontent.com/RobinL/0ee2e59db8cbecc105942fe4b101e847/raw/110e5bb3b574b7584b5452d4accfcfad71f2b19d/first_name_noyear.csv\", d3.autoType).then(function (csv_file) {\n      var lookup = {};\n      csv_file.forEach(function (row) {\n        lookup[row.firstname] = row.freq;\n      });\n      return lookup;\n    });\n  });\n  main.variable(observer(\"surname_lookup\")).define(\"surname_lookup\", [\"d3\"], function (d3) {\n    return d3.csv(\"https://gist.githubusercontent.com/RobinL/0ee2e59db8cbecc105942fe4b101e847/raw/110e5bb3b574b7584b5452d4accfcfad71f2b19d/last_name.csv\", d3.autoType).then(function (csv_file) {\n      var lookup = {};\n      csv_file.forEach(function (row) {\n        lookup[row.surname] = row.freq;\n      });\n      return lookup;\n    });\n  });\n  main.variable(observer(\"term_freqs\")).define(\"term_freqs\", [\"first_name_lookup\", \"surname_lookup\"], function (first_name_lookup, surname_lookup) {\n    return {\n      fname: first_name_lookup,\n      sname: surname_lookup\n    };\n  });\n  main.variable(observer()).define([\"term_freqs\"], function (term_freqs) {\n    return term_freqs.fname[\"joshua\"];\n  });\n  main.variable(observer()).define([\"term_freqs\"], function (term_freqs) {\n    return term_freqs.sname[\"linacre\"];\n  });\n  return main;\n}","import _taggedTemplateLiteral from \"/home/runner/work/robinl.github.io/robinl.github.io/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4;\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nimport define1 from \"./ef62bc8f8c0d577e@90.js\";\nimport define2 from \"./843cb6e82d7c3d9b@474.js\";\nimport define3 from \"./d25176b0fe784ad0@488.js\";\nimport define4 from \"./79750b3b8e929d9d@209.js\";\nexport default function define(runtime, observer) {\n  var main = runtime.module();\n  main.variable(observer()).define([\"md\"], function (md) {\n    return md(_templateObject || (_templateObject = _taggedTemplateLiteral([\"# Charts and Figures (Introduction)\"])));\n  });\n  var child1 = runtime.module(define1);\n  main.import(\"Record\", child1);\n  main.import(\"RecordComparison\", child1);\n  var child2 = runtime.module(define2);\n  main.import(\"get_waterfall_chart\", child2);\n  main.variable(observer(\"example_record_1_l\")).define(\"example_record_1_l\", [\"Record\"], function (Record) {\n    return new Record({\n      first_name: \"John\",\n      surname: \"Smith\",\n      date_of_birth: \"1989-03-02\",\n      town: \"Bristol\"\n    });\n  });\n  main.variable(observer(\"example_record_1_r\")).define(\"example_record_1_r\", [\"Record\"], function (Record) {\n    return new Record({\n      first_name: \"John\",\n      surname: \"Smith\",\n      date_of_birth: \"1989-03-02\",\n      town: \"Bath\"\n    });\n  });\n  main.variable(observer(\"example_1_comparison\")).define(\"example_1_comparison\", [\"RecordComparison\", \"example_record_1_l\", \"example_record_1_r\"], function (RecordComparison, example_record_1_l, example_record_1_r) {\n    return new RecordComparison(example_record_1_l, example_record_1_r);\n  });\n  main.variable(observer(\"splink_settings\")).define(\"splink_settings\", function () {\n    return {\n      proportion_of_matches: 1 / 100,\n      comparison_columns: [{\n        num_levels: 3,\n        col_name: \"first_name\",\n        u_probabilities: [0.8, 0.2],\n        m_probabilities: [0.2, 0.8]\n      }, {\n        num_levels: 3,\n        col_name: \"surname\",\n        u_probabilities: [0.9, 0.1],\n        m_probabilities: [0.2, 0.8]\n      }, {\n        col_name: \"date_of_birth\",\n        u_probabilities: [0.99, 0.01],\n        m_probabilities: [0.2, 0.8]\n      }, {\n        col_name: \"town\",\n        u_probabilities: [0.7, 0.3],\n        m_probabilities: [0.3, 0.7]\n      }]\n    };\n  });\n  main.variable(observer(\"example_1_row_with_gammas\")).define(\"example_1_row_with_gammas\", [\"example_1_comparison\", \"example_record_1_l\"], function (example_1_comparison, example_record_1_l) {\n    var row = example_1_comparison.as_wide().objects()[0];\n    Object.keys(example_record_1_l.as_dict()).forEach(function (k) {\n      if (row[k + \"_l\"] == row[k + \"_r\"]) {\n        row[\"𝛾_\" + k] = 1;\n      } else {\n        row[\"𝛾_\" + k] = 0;\n      }\n    });\n    return row;\n  });\n  main.variable(observer(\"overrides\")).define(\"overrides\", function () {\n    return {\n      title: {\n        text: \"Match weights and their cumulative contribution to match probability\",\n        subtitle: \"\"\n      },\n      height: 200\n    };\n  });\n  main.variable(observer(\"intro_simple_waterfall\")).define(\"intro_simple_waterfall\", [\"get_waterfall_chart\", \"example_1_row_with_gammas\", \"splink_settings\", \"overrides\"], function (get_waterfall_chart, example_1_row_with_gammas, splink_settings, overrides) {\n    return get_waterfall_chart(example_1_row_with_gammas, splink_settings, overrides, true);\n  });\n  main.variable(observer()).define([\"md\"], function (md) {\n    return md(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"# Charts and Figures (Mathematical Model)\"])));\n  });\n  var child3 = runtime.module(define3);\n  main.import(\"get_df_comparison\", child3);\n  main.import(\"get_df_gammas\", child3);\n  main.variable(observer(\"parseTableData\")).define(\"parseTableData\", function () {\n    return function parseTableData(table) {\n      var data = [];\n      var replace_lookup = {\n        \"unique id\": \"uid\",\n        \"first name\": \"fname\",\n        surname: \"sname\",\n        \"date of birth\": \"dob\",\n        town: \"town\"\n      };\n      table.querySelectorAll(\"tr\").forEach(function (row, i) {\n        var cells = row.cells;\n        var row_data = [];\n\n        var _iterator = _createForOfIteratorHelper(cells),\n            _step;\n\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var cell = _step.value;\n            var value = cell.innerText;\n            value = value.trim();\n            value = value.toLowerCase();\n\n            if (value == \"\") {\n              value = null;\n            }\n\n            row_data.push(value);\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n\n        data.push(row_data);\n      });\n      var formattedData = data.reduce(function (accumulator, row, i) {\n        if (i == 0) {\n          row = row.map(function (d) {\n            return replace_lookup[d];\n          });\n          accumulator.properties = row;\n        } else {\n          var rowObject = {};\n          accumulator.properties.forEach(function (key, i) {\n            rowObject[key] = row[i];\n          });\n          accumulator.push(rowObject);\n        }\n\n        return accumulator;\n      }, []);\n      return formattedData;\n    };\n  });\n  main.variable(observer(\"records_l\")).define(\"records_l\", [\"Generators\", \"parseTableData\", \"table_l\"], function (Generators, parseTableData, table_l) {\n    return Generators.observe(function (notify) {\n      var keyinput = function keyinput(event) {\n        return notify(parseTableData(table_l));\n      };\n\n      table_l.addEventListener(\"input\", keyinput, false);\n      notify(parseTableData(table_l));\n      return function () {\n        return window.removeEventListener(\"input\", keyinput);\n      };\n    });\n  });\n  main.variable(observer(\"table_l\")).define(\"table_l\", [\"html\"], function (html) {\n    return html(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"\\n<table id=\\\"data-table\\\" >\\n\\n<tr>\\n\\n<th>Unique ID</th>\\n<th>First name</th>\\n<th>Surname</th>\\n<th>Date of Birth</th>\\n<th>Town</th>\\n\\n</tr>\\n\\n<tr>\\n<td>1_l</td>\\n<td contenteditable>John</td>\\n\\n<td contenteditable>Smith</td>\\n<td contenteditable>1989-03-02</td>\\n<td contenteditable>Bristol</td>\\n\\n</tr>\\n\\n\\n<tr>\\n<td>2_l</td>\\n<td contenteditable>Emma</td>\\n\\n<td contenteditable>Jones</td>\\n<td contenteditable>1956-07-09</td>\\n<td contenteditable>Hull</td>\\n\\n</tr>\\n\\n\\n<tr>\\n<td>3_l</td>\\n<td contenteditable>David</td>\\n\\n<td contenteditable>Smith</td>\\n<td contenteditable>1981-08-21</td>\\n<td contenteditable>London</td>\\n\\n</tr>\\n\\n\\n</table>\\n\"])));\n  });\n  main.variable(observer(\"table_r\")).define(\"table_r\", [\"html\"], function (html) {\n    return html(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"\\n<table id=\\\"data-table\\\" >\\n\\n<tr>\\n\\n<th>Unique ID</th>\\n<th>First name</th>\\n<th>Surname</th>\\n<th>Date of Birth</th>\\n<th>Town</th>\\n\\n</tr>\\n\\n<tr>\\n<td>1_l</td>\\n<td contenteditable>Jonathan</td>\\n\\n<td contenteditable>Smith</td>\\n<td contenteditable>1989-03-02</td>\\n<td contenteditable>Bristol</td>\\n\\n</tr>\\n\\n\\n<tr>\\n<td>2_l</td>\\n<td contenteditable>David</td>\\n\\n<td contenteditable>Smith</td>\\n<td contenteditable>1981-08-21</td>\\n<td contenteditable>Peckham</td>\\n\\n</tr>\\n\\n\\n\\n\\n\\n</table>\\n\"])));\n  });\n  main.variable(observer(\"records_r\")).define(\"records_r\", [\"Generators\", \"parseTableData\", \"table_r\"], function (Generators, parseTableData, table_r) {\n    return Generators.observe(function (notify) {\n      var keyinput = function keyinput(event) {\n        return notify(parseTableData(table_r));\n      };\n\n      table_r.addEventListener(\"input\", keyinput, false);\n      notify(parseTableData(table_r));\n      return function () {\n        return window.removeEventListener(\"input\", keyinput);\n      };\n    });\n  });\n  main.variable(observer(\"df_1_l\")).define(\"df_1_l\", [\"aq\", \"records_l\"], function (aq, records_l) {\n    return aq.from(records_l);\n  });\n  main.variable(observer(\"df_1_r\")).define(\"df_1_r\", [\"aq\", \"records_r\"], function (aq, records_r) {\n    return aq.from(records_r);\n  });\n  main.variable(observer(\"df_comparisons_1\")).define(\"df_comparisons_1\", [\"get_df_comparison\", \"records_l\", \"records_r\"], function (get_df_comparison, records_l, records_r) {\n    return get_df_comparison(records_l, records_r);\n  });\n  main.variable(observer(\"df_gammas_1\")).define(\"df_gammas_1\", [\"get_df_gammas\", \"df_comparisons_1\", \"splink_settings_1\"], function (get_df_gammas, df_comparisons_1, splink_settings_1) {\n    return get_df_gammas(df_comparisons_1, splink_settings_1);\n  });\n  main.variable(observer(\"df_gammas_only_1\")).define(\"df_gammas_only_1\", [\"df_gammas_1\"], function (df_gammas_1) {\n    var uids = [\"uid_l\", \"uid_r\"];\n    var colnames = df_gammas_1.columnNames();\n    colnames = colnames.filter(function (d) {\n      return d.includes(\"𝛾_\");\n    });\n    colnames = uids.concat(colnames);\n    return df_gammas_1.select(colnames);\n  });\n  main.variable(observer(\"splink_settings_1\")).define(\"splink_settings_1\", function () {\n    return {\n      proportion_of_matches: 1 / 100,\n      comparison_columns: [{\n        num_levels: 3,\n        col_name: \"fname\",\n        u_probabilities: [0.8, 0.2],\n        m_probabilities: [0.2, 0.8],\n        case_expression: function case_expression(row) {\n          if (row.fname_l == row.fname_r) {\n            return 1;\n          } else {\n            return 0;\n          }\n        }\n      }, {\n        num_levels: 3,\n        col_name: \"sname\",\n        u_probabilities: [0.9, 0.1],\n        m_probabilities: [0.2, 0.8],\n        case_expression: function case_expression(row) {\n          if (row.sname_l == row.sname_r) {\n            return 1;\n          } else {\n            return 0;\n          }\n        }\n      }, {\n        col_name: \"dob\",\n        u_probabilities: [0.99, 0.01],\n        m_probabilities: [0.2, 0.8],\n        case_expression: function case_expression(row) {\n          if (row.dob_l == row.dob_r) {\n            return 1;\n          } else {\n            return 0;\n          }\n        }\n      }, {\n        col_name: \"town\",\n        u_probabilities: [0.7, 0.3],\n        m_probabilities: [0.3, 0.7],\n        case_expression: function case_expression(row) {\n          if (row.town_l == row.town_r) {\n            return 1;\n          } else {\n            return 0;\n          }\n        }\n      }]\n    };\n  });\n  main.variable(observer(\"example_record_2_l\")).define(\"example_record_2_l\", [\"Record\"], function (Record) {\n    return new Record({\n      first_name: \"Tom\",\n      surname: \"Hanks\",\n      month_of_birth: \"July\"\n    });\n  });\n  main.variable(observer(\"example_record_2_r\")).define(\"example_record_2_r\", [\"Record\"], function (Record) {\n    return new Record({\n      first_name: \"Tom\",\n      surname: \"Hanks\",\n      month_of_birth: \"June\"\n    });\n  });\n  main.variable(observer(\"example_2_comparison\")).define(\"example_2_comparison\", [\"RecordComparison\", \"example_record_2_l\", \"example_record_2_r\"], function (RecordComparison, example_record_2_l, example_record_2_r) {\n    return new RecordComparison(example_record_2_l, example_record_2_r);\n  });\n  var child4 = runtime.module(define4);\n  main.import(\"aq\", child4);\n  main.import(\"op\", child4);\n  return main;\n}","import _taggedTemplateLiteral from \"/home/runner/work/robinl.github.io/robinl.github.io/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _templateObject;\n\nexport default function define(runtime, observer) {\n  var main = runtime.module();\n  main.variable(observer()).define([\"md\"], function (md) {\n    return md(_templateObject || (_templateObject = _taggedTemplateLiteral([\"# Match Weights Charts\"])));\n  });\n  main.variable(observer(\"base_spec_m_u\")).define(\"base_spec_m_u\", [\"width\"], function (width) {\n    return {\n      config: {\n        view: {\n          width: width / 3,\n          height: 300\n        },\n        title: {\n          anchor: \"middle\",\n          offset: 10\n        },\n        header: {\n          title: null\n        }\n      },\n      hconcat: [{\n        mark: \"bar\",\n        title: {\n          text: \"Non-matches\",\n          fontWeight: \"normal\"\n        },\n        encoding: {\n          row: {\n            type: \"nominal\",\n            field: \"column_name\",\n            sort: {\n              field: \"gamma_index\"\n            },\n            header: {\n              labelAngle: 0,\n              labelAnchor: \"middle\",\n              labelAlign: \"left\"\n            }\n          },\n          x: {\n            type: \"quantitative\",\n            field: \"u_probability\",\n            axis: {\n              title: \"proportion\"\n            }\n          },\n          y: {\n            type: \"nominal\",\n            axis: {\n              title: null\n            },\n            field: \"level_name\"\n          },\n          tooltip: [{\n            type: \"nominal\",\n            field: \"column_name\"\n          }, {\n            type: \"ordinal\",\n            field: \"level_name\"\n          }, {\n            type: \"quantitative\",\n            field: \"u_probability\",\n            format: \".4f\"\n          }, {\n            type: \"quantitative\",\n            field: \"bayes_factor\",\n            format: \".4f\"\n          }, {\n            type: \"nominal\",\n            field: \"level_proportion\",\n            title: \"Percentage of record comparisons in this level\",\n            format: \".2%\"\n          }, {\n            type: \"quantitative\",\n            field: \"log2_bayes_factor\",\n            format: \".4f\"\n          }],\n          color: {\n            value: \"red\"\n          }\n        },\n        resolve: {\n          scale: {\n            y: \"independent\"\n          }\n        },\n        transform: [{\n          filter: \"(datum.bayes_factor != 'unnecessary filter2 due to vega lite issue 4680')\"\n        }],\n        // width: width / 2,\n        height: 50\n      }, {\n        mark: \"bar\",\n        title: {\n          text: \"Matches\",\n          fontWeight: \"normal\"\n        },\n        encoding: {\n          row: {\n            type: \"nominal\",\n            field: \"column_name\",\n            sort: {\n              field: \"gamma_index\"\n            },\n            header: {\n              labels: false\n            }\n          },\n          x: {\n            type: \"quantitative\",\n            field: \"m_probability\",\n            axis: {\n              title: \"proportion\"\n            }\n          },\n          y: {\n            type: \"nominal\",\n            axis: {\n              title: null\n            },\n            field: \"level_name\"\n          },\n          tooltip: [{\n            type: \"nominal\",\n            field: \"column_name\"\n          }, {\n            type: \"ordinal\",\n            field: \"level_name\"\n          }, {\n            type: \"quantitative\",\n            field: \"m_probability\",\n            format: \".4f\"\n          }, {\n            type: \"quantitative\",\n            field: \"bayes_factor\",\n            format: \".4f\"\n          }, {\n            type: \"nominal\",\n            field: \"level_proportion\",\n            title: \"Percentage of record comparisons in this level\",\n            format: \".2%\"\n          }, {\n            type: \"quantitative\",\n            field: \"log2_bayes_factor\",\n            format: \".4f\"\n          }],\n          color: {\n            value: \"green\"\n          }\n        },\n        resolve: {\n          scale: {\n            y: \"independent\"\n          }\n        },\n        transform: [{\n          filter: \"(datum.bayes_factor != 'unnecessary filter due to vega lite issue 4680')\"\n        }],\n        // width: width / 2,\n        height: 50\n      }],\n      data: {\n        values: null\n      },\n      transform: [],\n      title: {\n        text: \"Probability distributions of non-matches and matches \",\n        subtitle: \"Estimated proportion of matches λ = \"\n      },\n      $schema: \"https://vega.github.io/schema/vega-lite/v4.json\"\n    };\n  });\n  main.variable(observer(\"base_spec_bayes_factors\")).define(\"base_spec_bayes_factors\", [\"width\"], function (width) {\n    return {\n      config: {\n        view: {\n          width: width / 1.5,\n          height: 300\n        },\n        mark: {\n          tooltip: null\n        },\n        title: {\n          anchor: \"middle\"\n        },\n        header: {\n          title: null\n        }\n      },\n      data: {\n        values: null\n      },\n      mark: {\n        type: \"bar\",\n        clip: true\n      },\n      selection: {\n        selector076: {\n          type: \"interval\",\n          bind: \"scales\",\n          encodings: [\"x\"]\n        }\n      },\n      encoding: {\n        color: {\n          type: \"quantitative\",\n          field: \"log2_bayes_factor\",\n          scale: {\n            range: [\"red\", \"orange\", \"green\"],\n            domain: [-10, 0, 10]\n          }\n        },\n        row: {\n          type: \"nominal\",\n          field: \"column_name\",\n          sort: {\n            field: \"gamma_index\"\n          },\n          header: {\n            labelAngle: 0,\n            labelAnchor: \"middle\",\n            labelAlign: \"left\"\n          }\n        },\n        tooltip: [{\n          type: \"nominal\",\n          field: \"column_name\"\n        }, {\n          type: \"ordinal\",\n          field: \"level_name\"\n        }, {\n          type: \"quantitative\",\n          field: \"m_probability\",\n          format: \".4f\"\n        }, {\n          type: \"quantitative\",\n          field: \"bayes_factor\",\n          format: \".4f\"\n        }, {\n          type: \"nominal\",\n          field: \"level_proportion\",\n          title: \"Percentage of record comparisons in this level\",\n          format: \".2%\"\n        }, {\n          type: \"quantitative\",\n          field: \"log2_bayes_factor\",\n          title: \"log2(Bayes factor, K = m/u)\",\n          format: \".4f\"\n        }],\n        x: {\n          type: \"quantitative\",\n          axis: {\n            title: \"log2(Bayes factor, K = m/u)\",\n            values: [-10, -5, 0, 5, 10]\n          },\n          field: \"log2_bayes_factor\",\n          scale: {\n            domain: [-10, 10]\n          }\n        },\n        y: {\n          type: \"nominal\",\n          field: \"level_name\",\n          axis: {\n            title: null\n          }\n        }\n      },\n      height: 50,\n      resolve: {\n        scale: {\n          y: \"independent\"\n        }\n      },\n      title: {\n        text: \"Influence of comparison vector values on match probability\",\n        subtitle: \"Use mousewheeel to zoom\"\n      },\n      $schema: \"https://vega.github.io/schema/vega-lite/v4.json\"\n    };\n  });\n  main.variable(observer(\"settings_example\")).define(\"settings_example\", [\"default_splink_settings\"], function (default_splink_settings) {\n    return JSON.parse(default_splink_settings);\n  });\n  main.variable(observer(\"chart_data_from_splink_settings\")).define(\"chart_data_from_splink_settings\", [\"get_chart_row\"], function (get_chart_row) {\n    return function chart_data_from_splink_settings(splink_settings) {\n      var chart_data = [];\n\n      var zip = function zip(a, b) {\n        return a.map(function (k, i) {\n          return [k, b[i]];\n        });\n      };\n\n      splink_settings.comparison_columns.forEach(function (cc) {\n        var zipped = zip(cc[\"m_probabilities\"], cc[\"u_probabilities\"]);\n        zipped.forEach(function (m_u_pair, index) {\n          var row = get_chart_row(m_u_pair, cc, index);\n          chart_data.push(row);\n        });\n      });\n      return chart_data;\n    };\n  });\n  main.variable(observer(\"get_m_u_chart\")).define(\"get_m_u_chart\", [\"base_spec_m_u\", \"chart_data_from_splink_settings\", \"embed\"], function (base_spec_m_u, chart_data_from_splink_settings, embed) {\n    return function get_m_u_chart(splink_setttings) {\n      var base_spec = JSON.parse(JSON.stringify(base_spec_m_u));\n      var lam = splink_setttings.proportion_of_matches;\n      base_spec.data.values = chart_data_from_splink_settings(splink_setttings);\n      base_spec.title.subtitle = \"Estimated proportion of matches \\u03BB = \".concat(lam);\n      return embed(base_spec);\n    };\n  });\n  main.variable(observer()).define([\"get_m_u_chart\", \"settings_example\"], function (get_m_u_chart, settings_example) {\n    return get_m_u_chart(settings_example);\n  });\n  main.variable(observer(\"get_bayes_factor_chart\")).define(\"get_bayes_factor_chart\", [\"base_spec_bayes_factors\", \"chart_data_from_splink_settings\", \"embed\"], function (base_spec_bayes_factors, chart_data_from_splink_settings, embed) {\n    return function get_bayes_factor_chart(splink_setttings) {\n      var base_spec = JSON.parse(JSON.stringify(base_spec_bayes_factors));\n      var lam = splink_setttings.proportion_of_matches;\n      base_spec.data.values = chart_data_from_splink_settings(splink_setttings);\n      base_spec.title.subtitle = \"Estimated proportion of matches \\u03BB = \".concat(lam.toPrecision(4));\n      return embed(base_spec);\n    };\n  });\n  main.variable(observer()).define([\"get_bayes_factor_chart\", \"settings_example\"], function (get_bayes_factor_chart, settings_example) {\n    return get_bayes_factor_chart(settings_example);\n  });\n  main.variable(observer(\"get_chart_row\")).define(\"get_chart_row\", function () {\n    return function get_chart_row(m_u_pair, comparison_column, index) {\n      var row = {};\n      var cc = comparison_column;\n      row[\"m_probability\"] = m_u_pair[0];\n      row[\"u_probability\"] = m_u_pair[1];\n      row[\"bayes_factor\"] = m_u_pair[0] / m_u_pair[1];\n      row[\"column_name\"] = cc[\"col_name\"];\n      row[\"log2_bayes_factor\"] = Math.log2(row[\"bayes_factor\"]);\n      row[\"gamma_index\"] = index;\n      row[\"gamma_column_name\"] = \"gamma_\" + cc[\"col_name\"];\n      row[\"level_name\"] = \"level_\" + index;\n      row[\"max_gamma_index\"] = cc.m_probabilities.length - 1;\n      row[\"num_levels\"] = cc.m_probabilities.length;\n      return row;\n    };\n  });\n  main.variable(observer(\"default_splink_settings\")).define(\"default_splink_settings\", function () {\n    return \"{\\n    \\\"proportion_of_matches\\\": 0.001,\\n    \\\"comparison_columns\\\": [\\n      {\\n        \\\"col_name\\\": \\\"fname\\\",\\n        \\\"u_probabilities\\\": [0.8, 0.2],\\n        \\\"m_probabilities\\\": [0.2, 0.8]\\n      },\\n      {\\n        \\\"col_name\\\": \\\"sname\\\",\\n        \\\"u_probabilities\\\": [0.9, 0.1],\\n        \\\"m_probabilities\\\": [0.2, 0.8]\\n      },\\n      {\\n        \\\"col_name\\\": \\\"dob\\\",\\n        \\\"u_probabilities\\\": [0.99, 0.01],\\n        \\\"m_probabilities\\\": [0.2, 0.8]\\n      },\\n      {\\n        \\\"col_name\\\": \\\"town\\\",\\n        \\\"u_probabilities\\\": [0.7, 0.3],\\n        \\\"m_probabilities\\\": [0.3, 0.7]\\n      }\\n    ]\\n  \\n  }\";\n  });\n  main.variable(observer(\"embed\")).define(\"embed\", [\"require\"], function (require) {\n    return require(\"vega-embed@6\");\n  });\n  return main;\n}","import _taggedTemplateLiteral from \"/home/runner/work/robinl.github.io/robinl.github.io/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4, _templateObject5, _templateObject6, _templateObject7, _templateObject8, _templateObject9, _templateObject10, _templateObject11, _templateObject12, _templateObject13, _templateObject14, _templateObject15, _templateObject16, _templateObject17, _templateObject18, _templateObject19, _templateObject20, _templateObject21, _templateObject22, _templateObject23, _templateObject24, _templateObject25, _templateObject26, _templateObject27, _templateObject28, _templateObject29, _templateObject30, _templateObject31, _templateObject32, _templateObject33, _templateObject34, _templateObject35, _templateObject36, _templateObject37, _templateObject38, _templateObject39, _templateObject40, _templateObject41, _templateObject42, _templateObject43, _templateObject44, _templateObject45, _templateObject46, _templateObject47, _templateObject48, _templateObject49, _templateObject50, _templateObject51, _templateObject52;\n\n// https://observablehq.com/@robinl/the-mathematics-of-the-fellegi-sunter-model@851\nimport define1 from \"./ea6530af059f37be@228.js\";\nimport define2 from \"./d25176b0fe784ad0@488.js\";\nexport default function define(runtime, observer) {\n  var main = runtime.module();\n  main.variable(observer(\"title\")).define(\"title\", [\"md\"], function (md) {\n    return md(_templateObject || (_templateObject = _taggedTemplateLiteral([\"# The mathematics of the Fellegi Sunter model\"])));\n  });\n  main.variable(observer()).define([\"md\"], function (md) {\n    return md(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"*A final version of this notebook can be viewed on my blog [here](https://www.robinlinacre.com/maths_of_fellegi_sunter/).*\"])));\n  });\n  main.variable(observer(\"para_1\")).define(\"para_1\", [\"md\"], function (md) {\n    return md(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"In this article, we present an implementation of [Fellegi and Sunter's model of probabilistic record linkage](https://courses.cs.washington.edu/courses/cse590q/04au/papers/Felligi69.pdf) (1969).  \\n\\nWe build up a simple Fellegi Sunter (FS) model piece by piece, demonstrating how it can be used to compute match probabilities. In this article, we assume parameters of the model are known. \\n\\nA more technical treatment is given in [AP\\tEnamorado, T., Fifield, B., & Imai, K. (2019)](https://imai.fas.harvard.edu/research/files/linkage.pdf), which contains a generalised form of the model.\"])));\n  });\n  main.variable(observer(\"para_2\")).define(\"para_2\", [\"md\"], function (md) {\n    return md(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"## Objective of the Model\\n\\nThe input to the FS model is a dataset of pairwise record comparisons.\\n\\nThe aim of the model is to estimate a 'match probability' for each pairwsie comparison, which quantifies the likelihood the two records  represent the same entity.\"])));\n  });\n  main.variable(observer(\"para_3\")).define(\"para_3\", [\"md\"], function (md) {\n    return md(_templateObject5 || (_templateObject5 = _taggedTemplateLiteral([\"## Set up\\n\\nThe FS model can be used to link and/or deduplicate one or more datasests. In what follows, let's assume we have two datasets we wish to link:\\n\\n\\u2728<span style=\\\"background-color:yellow\\\">You can edit the records in the tables, and all of the subsequent calculations will update accordingly.</span>\\u2728\\n\\n### Dataset 1\\n\\n\"])));\n  });\n  main.variable(observer(\"table_l1\")).define(\"table_l1\", [\"table_l\"], function (table_l) {\n    return table_l;\n  });\n  main.variable(observer(\"ds2_head\")).define(\"ds2_head\", [\"md\"], function (md) {\n    return md(_templateObject6 || (_templateObject6 = _taggedTemplateLiteral([\"### Dataset 2\"])));\n  });\n  main.variable(observer(\"table_r1\")).define(\"table_r1\", [\"table_r\"], function (table_r) {\n    return table_r;\n  });\n  main.variable(observer(\"rec_comparisons\")).define(\"rec_comparisons\", [\"md\", \"df_comparisons_1\"], function (md, df_comparisons_1) {\n    return md(_templateObject7 || (_templateObject7 = _taggedTemplateLiteral([\"\\n\\nTo be compatible with the FS model, the input data must be converted into pairwise comparisons as follows:\\n\\n### Record comparisons\\n\\n\", \"\\n<br>\\nThis table compares every row in dataset 1 to every row in dataset 2.  \\n\"])), df_comparisons_1.view());\n  });\n  main.variable(observer(\"para_4\")).define(\"para_4\", [\"md\", \"df_gammas_1\", \"df_gammas_only_1\", \"texd\", \"get_comparison_vector_symbols_and_numbers\", \"settings\"], function (md, df_gammas_1, df_gammas_only_1, texd, get_comparison_vector_symbols_and_numbers, settings) {\n    return md(_templateObject8 || (_templateObject8 = _taggedTemplateLiteral([\"## Comparing columns\\n\\nWe need a mathematical way of evaluating these pairwise comparisons - a function that takes the comparisons as an input, and outputs match probabilities.  \\n\\nThe FS model solves this problem by comparing the records column by column, and assigning each comparison to two or more 'similarity levels'.\\n\\nA simple example of a two-level comparison rule for a column may be:\\n\\n- If the values in the column exactly match, assign the comparison to similarity level 1\\n- Otherwise assign the comparison to similarity level 0\\n\\nIn the following table, we apply this simple rule to every column. The comparisons are denoted with the prefix `\\uD835\\uDEFE_` because the mathematical symbol gamma is often used in the literate to represent comparisons.\\n\\n\", \"\\n\\n<br>\\n\\nNow that we have a numeric representation of the comparisons, the model makes no further use of the raw data, instead using only the values in the \\uD835\\uDEFE columns: \\n\\n\", \"   \\n<br>\\nFor each row in this table, the set of gamma values is known as the 'comparison vector'.  For example, the comparison vector for the first row in the table is:\\n\\n\", \"\\n \"], [\"## Comparing columns\\n\\nWe need a mathematical way of evaluating these pairwise comparisons - a function that takes the comparisons as an input, and outputs match probabilities.  \\n\\nThe FS model solves this problem by comparing the records column by column, and assigning each comparison to two or more 'similarity levels'.\\n\\nA simple example of a two-level comparison rule for a column may be:\\n\\n- If the values in the column exactly match, assign the comparison to similarity level 1\\n- Otherwise assign the comparison to similarity level 0\\n\\nIn the following table, we apply this simple rule to every column. The comparisons are denoted with the prefix \\\\`\\uD835\\uDEFE_\\\\` because the mathematical symbol gamma is often used in the literate to represent comparisons.\\n\\n\", \"\\n\\n<br>\\n\\nNow that we have a numeric representation of the comparisons, the model makes no further use of the raw data, instead using only the values in the \\uD835\\uDEFE columns: \\n\\n\", \"   \\n<br>\\nFor each row in this table, the set of gamma values is known as the 'comparison vector'.  For example, the comparison vector for the first row in the table is:\\n\\n\", \"\\n \"])), df_gammas_1.view(), df_gammas_only_1.view(), texd(_templateObject9 || (_templateObject9 = _taggedTemplateLiteral([\"\", \"\"])), get_comparison_vector_symbols_and_numbers(df_gammas_1.slice(1 - 1, 1).objects()[0], settings)));\n  });\n  main.variable(observer(\"subhead_1\")).define(\"subhead_1\", [\"md\"], function (md) {\n    return md(_templateObject10 || (_templateObject10 = _taggedTemplateLiteral([\"## Scoring comparisons\"])));\n  });\n  main.variable(observer(\"para_5\")).define(\"para_5\", [\"md\"], function (md) {\n    return md(_templateObject11 || (_templateObject11 = _taggedTemplateLiteral([\"We now need a way of recombining these individual column comparisons into an overall match probability.  \\n\\nWe will want this approach to account for the differing importance of columns.  For example, a match on gender is less informative than a match on date of birth.\\n\\nThe FS model approaches this problem by estimating match weights for each individual column and combining these match weights.  \\n\\nBy assuming mutual independence of the features, each column can be accounted for separately, dramatically simplifying the maths.  \\n\\nIn particular, this assumption makes the model equivalent to a [Na\\xEFve Bayes](https://en.wikipedia.org/wiki/Naive_Bayes_classifier) classifier.  This allows the match probability to be expressed as a repeated multiplication of conditional probabilities. Further mathmetical details can be found [here](https://en.wikipedia.org/wiki/Naive_Bayes_classifier#Probabilistic_model).\\n\\nIn our case, 'mutual independence of features' means that linkage variables must be independent given the match status.  \\n\\nThis would be violated if amongst matching records, a typo on first name was correlated with a typo on surname.  Another  violation often occurs with addresses if they are separated into multiple columns: Amongst matching records, a match on postcode typically implies a match on town.  \\n\\nTo further understand how we account for each comparison column in the computation of match probability, we need to introduce the concept of `m` and `u` probabilities.\\n\"], [\"We now need a way of recombining these individual column comparisons into an overall match probability.  \\n\\nWe will want this approach to account for the differing importance of columns.  For example, a match on gender is less informative than a match on date of birth.\\n\\nThe FS model approaches this problem by estimating match weights for each individual column and combining these match weights.  \\n\\nBy assuming mutual independence of the features, each column can be accounted for separately, dramatically simplifying the maths.  \\n\\nIn particular, this assumption makes the model equivalent to a [Na\\xEFve Bayes](https://en.wikipedia.org/wiki/Naive_Bayes_classifier) classifier.  This allows the match probability to be expressed as a repeated multiplication of conditional probabilities. Further mathmetical details can be found [here](https://en.wikipedia.org/wiki/Naive_Bayes_classifier#Probabilistic_model).\\n\\nIn our case, 'mutual independence of features' means that linkage variables must be independent given the match status.  \\n\\nThis would be violated if amongst matching records, a typo on first name was correlated with a typo on surname.  Another  violation often occurs with addresses if they are separated into multiple columns: Amongst matching records, a match on postcode typically implies a match on town.  \\n\\nTo further understand how we account for each comparison column in the computation of match probability, we need to introduce the concept of \\\\`m\\\\` and \\\\`u\\\\` probabilities.\\n\"])));\n  });\n  main.variable(observer(\"para_6\")).define(\"para_6\", [\"md\", \"texd\"], function (md, texd) {\n    return md(_templateObject12 || (_templateObject12 = _taggedTemplateLiteral([\"### m and u probabilities \\n\\nHow much should we increase our estimate of match probability if we observe a match on first name? How about a match on gender? And what about if we observe a mismatch on these fields?  \\n\\nWe are interested in evaluating statements like: \\n\\n\", \" \\n\\nThis can be quantified using the m and u probabilities for each column, combined with Bayes Theorem (see annex for a refresher).\\n\\nConsider the first name column.  We have defined two similarity levels:  level 1 if the first name exactly matches, and level 0 otherwise.\\n\\n#### m probabilities\\nThe m probabilities for the first name column are:\\n\\n\", \"\\n\\n\\n\", \"\\n\\n\\nThat is, amongst record comparisons which are true matches, what proportion have a match on first name, and what proportion mismatch on first name?\\n\\nThis is a measure of how often mispellings, nicknames or aliases occur in the first name field.\\n\\n#### u probabilities\\n\\nThe u probabilities for the first name column are:\\n\\n\", \"\\n\\n\\n\", \"\\n\\n\\n\\nThat is, amongst record comparisons which are true non-matches, what proportion have a match on first name, and what proportion mismatch on first name?\\n\\nThis is a measure of how likely 'collisions' are likely to occur. For instance, it would be common for two different people to have the same gender, but less likely for two different people to have the same date of birth.\\n\\n#### The overall proportion of matches\\n\\nLet us also define:\\n\\n\", \" \\n\\nThis is our prior - our estimate for the probability that a randomly-chosen pairwise record comparison is a match.\\n\\n### Bayes Theorem\\n\\nWe can now use Bayes Theorem  to write:\\n\\n\", \"\\n\\nwhich, in our notation is:\\n\\n\", \"\\n\\n\\n\"])), texd(_templateObject13 || (_templateObject13 = _taggedTemplateLiteral([\"operatorname{Pr}(\\text{records match}|\\text{first name matches})\"], [\"\\\\operatorname{Pr}(\\\\text{records match}|\\\\text{first name matches})\"]))), texd(_templateObject14 || (_templateObject14 = _taggedTemplateLiteral([\"m_\\text{first name,level_0} = operatorname{Pr}(\\text{first name does not match}|\\text{record match})\"], [\"m_\\\\text{first name,level\\\\_0} = \\\\operatorname{Pr}(\\\\text{first name does not match}|\\\\text{record match})\"]))), texd(_templateObject15 || (_templateObject15 = _taggedTemplateLiteral([\"m_\\text{first name, level_1} = operatorname{Pr}(\\text{first name matches}|\\text{records match})\"], [\"m_\\\\text{first name, level\\\\_1} = \\\\operatorname{Pr}(\\\\text{first name matches}|\\\\text{records match})\"]))), texd(_templateObject16 || (_templateObject16 = _taggedTemplateLiteral([\"u_\\text{first name, level_0} = operatorname{Pr}(\\text{first name does not match}|\\text{records do not match})\"], [\"u_\\\\text{first name, level\\\\_0} = \\\\operatorname{Pr}(\\\\text{first name does not match}|\\\\text{records do not match})\"]))), texd(_templateObject17 || (_templateObject17 = _taggedTemplateLiteral([\"u_\\text{first name, level_1} = operatorname{Pr}(\\text{first name matches}|\\text{records do not match})\"], [\"u_\\\\text{first name, level\\\\_1} = \\\\operatorname{Pr}(\\\\text{first name matches}|\\\\text{records do not match})\"]))), texd(_templateObject18 || (_templateObject18 = _taggedTemplateLiteral([\"operatorname{Pr}(\\text{records match}) = lambda\"], [\"\\\\operatorname{Pr}(\\\\text{records match}) = \\\\lambda\"]))), texd(_templateObject19 || (_templateObject19 = _taggedTemplateLiteral([\"\\n\\text{posterior} = operatorname{Pr}(\\text{records match}|\\text{first name matches}) \\newline [10pt] = \\frac{operatorname{Pr}(\\text{first name matches}|\\text{records match})operatorname{Pr}(\\text{records match})}{operatorname{Pr}{(\\text{first name matches})}}\"], [\"\\n\\\\text{posterior} = \\\\operatorname{Pr}(\\\\text{records match}|\\\\text{first name matches}) \\\\newline [10pt] = \\\\frac{\\\\operatorname{Pr}(\\\\text{first name matches}|\\\\text{records match})\\\\operatorname{Pr}(\\\\text{records match})}{\\\\operatorname{Pr}{(\\\\text{first name matches})}}\"]))), texd(_templateObject20 || (_templateObject20 = _taggedTemplateLiteral([\"\\n\\text{posterior} = operatorname{Pr}(\\text{records match}|\\text{first name matches}) \\newline [10pt] = \\frac{m_\\text{first name, level_1}lambda}{m_\\text{first name, level_1}lambda + u_\\text{first name, level_1}(1-lambda)}\"], [\"\\n\\\\text{posterior} = \\\\operatorname{Pr}(\\\\text{records match}|\\\\text{first name matches}) \\\\newline [10pt] = \\\\frac{m_\\\\text{first name, level\\\\_1}\\\\lambda}{m_\\\\text{first name, level\\\\_1}\\\\lambda + u_\\\\text{first name, level\\\\_1}(1-\\\\lambda)}\"]))));\n  });\n  main.variable(observer(\"para_7\")).define(\"para_7\", [\"md\", \"tex\", \"texd\"], function (md, tex, texd) {\n    return md(_templateObject21 || (_templateObject21 = _taggedTemplateLiteral([\"We can generalise this formula by using  \", \" to indicate the value of the comparison, the index \", \" to designate the comparison column, and \", \" to designate the observed comparison level, we can write:\\n\\n\", \"\\n\\nFinally, by assuming conditional independence among linkage variables given the match status, we can account for more than one comparison column.  For instance, in the case of two comparison columns\\n\\n\", \"\\n\\nLeading to the following formula that takes into account all column comparisons:\\n\\n#### Equation 1:\\n\", \"\\n\\n\\nThis equation provides the output of the Fellegi Sunter model - an estimate of the probability that two records match given the information contained\\n\\n\"])), tex(_templateObject22 || (_templateObject22 = _taggedTemplateLiteral([\"gamma\"], [\"\\\\gamma\"]))), tex(_templateObject23 || (_templateObject23 = _taggedTemplateLiteral([\"k\"]))), tex(_templateObject24 || (_templateObject24 = _taggedTemplateLiteral([\"ell\"], [\"\\\\ell\"]))), texd(_templateObject25 || (_templateObject25 = _taggedTemplateLiteral([\"\\n\\text{posterior} = operatorname{Pr}(\\text{records match}|gamma_{k}) \\newline [10pt] = \\frac{lambda m_{kell}}{lambda m_{kell}+ u_{kell}(1-lambda)}\"], [\"\\n\\\\text{posterior} = \\\\operatorname{Pr}(\\\\text{records match}|\\\\gamma_{k}) \\\\newline [10pt] = \\\\frac{\\\\lambda m_{k\\\\ell}}{\\\\lambda m_{k\\\\ell}+ u_{k\\\\ell}(1-\\\\lambda)}\"]))), texd(_templateObject26 || (_templateObject26 = _taggedTemplateLiteral([\"\\noperatorname{Pr}(\\text{records match}|gamma_{1},gamma_{2}) \\newline [10pt] = \\frac{operatorname{Pr}(gamma_{1}|\\text{records match})operatorname{Pr}(gamma_{2}|\\text{records match})operatorname{Pr}(\\text{records match})}{operatorname{Pr}{(gamma_{1},gamma_{2})}}\"], [\"\\n\\\\operatorname{Pr}(\\\\text{records match}|\\\\gamma_{1},\\\\gamma_{2}) \\\\newline [10pt] = \\\\frac{\\\\operatorname{Pr}(\\\\gamma_{1}|\\\\text{records match})\\\\operatorname{Pr}(\\\\gamma_{2}|\\\\text{records match})\\\\operatorname{Pr}(\\\\text{records match})}{\\\\operatorname{Pr}{(\\\\gamma_{1},\\\\gamma_{2})}}\"]))), texd(_templateObject27 || (_templateObject27 = _taggedTemplateLiteral([\"\\noperatorname{Pr}(\\text{records match}|gamma_{1},gamma_{2},ldots,gamma_{K})  \\newline [10pt] = \\frac{lambda m_{1ell}m_{2ell}ldots m_{Kell}}{lambda m_{1ell}m_{2ell}ldots m_{Kell}+ (1-lambda)u_{1ell}u_{1ell} ldots u_{Kell}} \"], [\"\\n\\\\operatorname{Pr}(\\\\text{records match}|\\\\gamma_{1},\\\\gamma_{2},\\\\ldots,\\\\gamma_{K})  \\\\newline [10pt] = \\\\frac{\\\\lambda m_{1\\\\ell}m_{2\\\\ell}\\\\ldots m_{K\\\\ell}}{\\\\lambda m_{1\\\\ell}m_{2\\\\ell}\\\\ldots m_{K\\\\ell}+ (1-\\\\lambda)u_{1\\\\ell}u_{1\\\\ell} \\\\ldots u_{K\\\\ell}} \"]))));\n  });\n  main.variable(observer(\"para_8\")).define(\"para_8\", [\"md\"], function (md) {\n    return md(_templateObject28 || (_templateObject28 = _taggedTemplateLiteral([\"In subsequent articles, we use the concepts of m and u probabilities to discuss the intuition behind match weights, and present graphical ways of interpreting the values.  \\n\\nWe finish this article with a worked example of the probability calculation.\"])));\n  });\n  main.variable(observer(\"subhead_2\")).define(\"subhead_2\", [\"md\"], function (md) {\n    return md(_templateObject29 || (_templateObject29 = _taggedTemplateLiteral([\"## Example\"])));\n  });\n  main.variable(observer(\"para_10\")).define(\"para_10\", [\"md\"], function (md) {\n    return md(_templateObject30 || (_templateObject30 = _taggedTemplateLiteral([\"\\nIn order to present an example calculation we need to choose values for the parameters of the model - the m and u values.\\n\\nWe can represent the m and u values for a comparison column succinctly as follows:\\n\\n```\\n{\\n  \\\"col_name\\\": \\\"fname\\\",\\n  \\\"m_probabilities\\\": [0.2,0.8],\\n  \\\"u_probabilities\\\": [0.9,0.1],\\n}\\n```\\n\\nThe position (index) of the arrays corresponds to the comparison level.  \\n\\nFor example, `\\\"m_probabilities\\\": [0.2,0.8]` means that amongst matching records, 20% have a disagreement on the first name (e.g. \\\"John\\\" vs. \\\"Jonathan\\\"), and 80% match (e.g. \\\"David\\\" vs. \\\"David\\\")\\n\\nUsing this notation, parameters we will choose for our model are as follows.  \\u2728<span style=\\\"background-color:yellow\\\">You may edit these values to see how they affect the calculation.</span>\\u2728\\n\\n\"], [\"\\nIn order to present an example calculation we need to choose values for the parameters of the model - the m and u values.\\n\\nWe can represent the m and u values for a comparison column succinctly as follows:\\n\\n\\\\`\\\\`\\\\`\\n{\\n  \\\"col_name\\\": \\\"fname\\\",\\n  \\\"m_probabilities\\\": [0.2,0.8],\\n  \\\"u_probabilities\\\": [0.9,0.1],\\n}\\n\\\\`\\\\`\\\\`\\n\\nThe position (index) of the arrays corresponds to the comparison level.  \\n\\nFor example, \\\\`\\\"m_probabilities\\\": [0.2,0.8]\\\\` means that amongst matching records, 20% have a disagreement on the first name (e.g. \\\"John\\\" vs. \\\"Jonathan\\\"), and 80% match (e.g. \\\"David\\\" vs. \\\"David\\\")\\n\\nUsing this notation, parameters we will choose for our model are as follows.  \\u2728<span style=\\\"background-color:yellow\\\">You may edit these values to see how they affect the calculation.</span>\\u2728\\n\\n\"])));\n  });\n  main.variable(observer(\"viewof splink_settings\")).define(\"viewof splink_settings\", [\"inputs\", \"default_splink_settings\"], function (inputs, default_splink_settings) {\n    return inputs.textarea({\n      value: default_splink_settings,\n      rows: 26,\n      spellcheck: false\n    });\n  });\n  main.variable(observer(\"splink_settings\")).define(\"splink_settings\", [\"Generators\", \"viewof splink_settings\"], function (G, _) {\n    return G.input(_);\n  });\n  main.variable(observer(\"para_11\")).define(\"para_11\", [\"md\"], function (md) {\n    return md(_templateObject31 || (_templateObject31 = _taggedTemplateLiteral([\"We will now present a worked example of the calculation of match probability for the following pairwise record comparison.  \\n\\n\\n\\u2728<span style=\\\"background-color:yellow\\\">You may change the record comparison using the control below</span>\\u2728\\n\"])));\n  });\n  main.variable(observer(\"viewof row_index\")).define(\"viewof row_index\", [\"inputs\", \"df_gammas_1\"], function (inputs, df_gammas_1) {\n    return inputs.range([1, df_gammas_1.numRows()], {\n      value: 1,\n      label: \"Choose record comparison\",\n      step: 1\n    });\n  });\n  main.variable(observer(\"row_index\")).define(\"row_index\", [\"Generators\", \"viewof row_index\"], function (G, _) {\n    return G.input(_);\n  });\n  main.variable(observer(\"this_row\")).define(\"this_row\", [\"md\", \"df_comparisons_1\", \"row_index\"], function (md, df_comparisons_1, row_index) {\n    return md(_templateObject32 || (_templateObject32 = _taggedTemplateLiteral([\"\", \"\"])), df_comparisons_1.slice(row_index - 1, row_index).toMarkdown());\n  });\n  main.variable(observer(\"para_12\")).define(\"para_12\", [\"md\", \"texd\", \"get_comparison_vector_symbols_and_numbers\", \"df_gammas_1\", \"row_index\", \"settings\"], function (md, texd, get_comparison_vector_symbols_and_numbers, df_gammas_1, row_index, settings) {\n    return md(_templateObject33 || (_templateObject33 = _taggedTemplateLiteral([\"The comparison vector is given by:\\n\\n\", \"\\n\\n\"])), texd(_templateObject34 || (_templateObject34 = _taggedTemplateLiteral([\"\", \"\"])), get_comparison_vector_symbols_and_numbers(df_gammas_1.slice(row_index - 1, row_index).objects()[0], settings)));\n  });\n  main.variable(observer(\"para_13\")).define(\"para_13\", [\"md\"], function (md) {\n    return md(_templateObject35 || (_templateObject35 = _taggedTemplateLiteral([\"The formula for match probability is:\"])));\n  });\n  main.variable(observer(\"para_14\")).define(\"para_14\", [\"texd\", \"get_m_u_formula_symbols\", \"df_gammas_1\", \"row_index\", \"settings\"], function (texd, get_m_u_formula_symbols, df_gammas_1, row_index, settings) {\n    return texd(_templateObject36 || (_templateObject36 = _taggedTemplateLiteral([\"\", \"\"])), get_m_u_formula_symbols(df_gammas_1.slice(row_index - 1, row_index).objects()[0], settings));\n  });\n  main.variable(observer(\"para_15\")).define(\"para_15\", [\"md\"], function (md) {\n    return md(_templateObject37 || (_templateObject37 = _taggedTemplateLiteral([\"And substituting in numbers using our specified parameters we get: \"])));\n  });\n  main.variable(observer(\"para_16\")).define(\"para_16\", [\"texd\", \"get_m_u_formula_numbers\", \"df_gammas_1\", \"row_index\", \"settings\"], function (texd, get_m_u_formula_numbers, df_gammas_1, row_index, settings) {\n    return texd(_templateObject38 || (_templateObject38 = _taggedTemplateLiteral([\"\", \"\"])), get_m_u_formula_numbers(df_gammas_1.slice(row_index - 1, row_index).objects()[0], settings));\n  });\n  main.variable(observer(\"para_17\")).define(\"para_17\", [\"md\", \"tex\", \"get_match_probability_components\", \"df_gammas_1\", \"row_index\", \"settings\"], function (md, tex, get_match_probability_components, df_gammas_1, row_index, settings) {\n    return md(_templateObject39 || (_templateObject39 = _taggedTemplateLiteral([\"i.e. the \", \"\\n\\n\"])), tex(_templateObject40 || (_templateObject40 = _taggedTemplateLiteral([\"\\text{estimated match probability} = \\n\\n\", \"\\n\\n\"], [\"\\\\text{estimated match probability} = \\n\\n\", \"\\n\\n\"])), get_match_probability_components(df_gammas_1.slice(row_index - 1, row_index).objects()[0], settings)[\"match_probability\"].toPrecision(4)));\n  });\n  main.variable(observer(\"para_18\")).define(\"para_18\", [\"md\"], function (md) {\n    return md(_templateObject41 || (_templateObject41 = _taggedTemplateLiteral([\"<br><br>\"])));\n  });\n  main.variable(observer(\"para_19\")).define(\"para_19\", [\"md\", \"texd\", \"tex\"], function (md, texd, tex) {\n    return md(_templateObject42 || (_templateObject42 = _taggedTemplateLiteral([\"## Annex:  Bayes Theorem\\n\\nRecall that Bayes Theorem is given by:\\n\\n\", \" \\n\\n\\nor , in words: \\n\\n\", \"\\n\\nIn the context of record linkage, we can describe these parts as:\\n\\n**Prior**:\\nThe overall proportion of comparisons which are matches \", \".\\n\\n**Evidence**: We have observed that e.g. first name matches, \", \".\\n\\n**Likelihood**: The probability that first name matches amongst matches, given by \", \".  \\n\\nSo Bayes' formuls is:\\n\\n\", \"\\n\\nWhich can also be written:\\n\\n\", \"\\n\\ngiving us:\\n\\n\", \"\\n\\nWhich is the same as Equation 1.\\n\"])), texd(_templateObject43 || (_templateObject43 = _taggedTemplateLiteral([\"\\noperatorname{Pr}(a|b) = {\\frac{operatorname{Pr}(b|a)operatorname{Pr}(a)}{operatorname{Pr}{(b)}}}\"], [\"\\n\\\\operatorname{Pr}(a|b) = {\\\\frac{\\\\operatorname{Pr}(b|a)\\\\operatorname{Pr}(a)}{\\\\operatorname{Pr}{(b)}}}\"]))), texd(_templateObject44 || (_templateObject44 = _taggedTemplateLiteral([\"\\n\\text{posterior} = \\frac{\\text{likelihood} \\times \\text{prior}}{\\text{evidence}}\"], [\"\\n\\\\text{posterior} = \\\\frac{\\\\text{likelihood} \\\\times \\\\text{prior}}{\\\\text{evidence}}\"]))), tex(_templateObject45 || (_templateObject45 = _taggedTemplateLiteral([\"operatorname{Pr}(\\text{match})\"], [\"\\\\operatorname{Pr}(\\\\text{match})\"]))), tex(_templateObject46 || (_templateObject46 = _taggedTemplateLiteral([\"operatorname{Pr}(\\text{first name matches})\"], [\"\\\\operatorname{Pr}(\\\\text{first name matches})\"]))), tex(_templateObject47 || (_templateObject47 = _taggedTemplateLiteral([\"operatorname{Pr}(\\text{first name matches}|\\text{records match})\"], [\"\\\\operatorname{Pr}(\\\\text{first name matches}|\\\\text{records match})\"]))), texd(_templateObject48 || (_templateObject48 = _taggedTemplateLiteral([\"\\noperatorname{Pr}(\\text{match}|\\text{first name matches}) = \\frac{operatorname{Pr}(\\text{first name matches}|\\text{match})operatorname{Pr}(\\text{match})}{operatorname{Pr}{(\\text{first name matches})}}\"], [\"\\n\\\\operatorname{Pr}(\\\\text{match}|\\\\text{first name matches}) = \\\\frac{\\\\operatorname{Pr}(\\\\text{first name matches}|\\\\text{match})\\\\operatorname{Pr}(\\\\text{match})}{\\\\operatorname{Pr}{(\\\\text{first name matches})}}\"]))), texd(_templateObject49 || (_templateObject49 = _taggedTemplateLiteral([\" \\n\\frac{operatorname{Pr}(\\text{first name matches}|\\text{match})operatorname{Pr}(\\text{match})}{operatorname{Pr}(\\text{first name matches}|\\text{match})operatorname{Pr}(\\text{match}) + operatorname{Pr}(\\text{first name matches}|\\text{non match})operatorname{Pr}(\\text{non match})}\"], [\" \\n\\\\frac{\\\\operatorname{Pr}(\\\\text{first name matches}|\\\\text{match})\\\\operatorname{Pr}(\\\\text{match})}{\\\\operatorname{Pr}(\\\\text{first name matches}|\\\\text{match})\\\\operatorname{Pr}(\\\\text{match}) + \\\\operatorname{Pr}(\\\\text{first name matches}|\\\\text{non match})\\\\operatorname{Pr}(\\\\text{non match})}\"]))), texd(_templateObject50 || (_templateObject50 = _taggedTemplateLiteral([\"\\noperatorname{Pr}(\\text{match}|\\text{first name matches}) = \\n\\frac{m_1lambda}{m_1lambda + u_1(1-lambda)}\"], [\"\\n\\\\operatorname{Pr}(\\\\text{match}|\\\\text{first name matches}) = \\n\\\\frac{m_1\\\\lambda}{m_1\\\\lambda + u_1(1-\\\\lambda)}\"]))));\n  });\n  main.variable(observer()).define([\"md\"], function (md) {\n    return md(_templateObject51 || (_templateObject51 = _taggedTemplateLiteral([\"## Calculations and code\"])));\n  });\n  var child1 = runtime.module(define1);\n  main.import(\"example_2_comparison\", child1);\n  main.import(\"intro_simple_waterfall\", child1);\n  main.import(\"table_l\", child1);\n  main.import(\"table_r\", child1);\n  main.import(\"df_1_l\", child1);\n  main.import(\"df_1_r\", child1);\n  main.import(\"df_comparisons_1\", child1);\n  main.import(\"df_gammas_1\", child1);\n  main.import(\"df_gammas_only_1\", child1);\n  var child2 = runtime.module(define2);\n  main.import(\"get_m_u_formula_symbols\", child2);\n  main.import(\"get_m_u_formula_numbers\", child2);\n  main.import(\"get_comparison_vector_symbols_and_numbers\", child2);\n  main.import(\"get_match_probability_components\", child2);\n  main.variable(observer(\"texd\")).define(\"texd\", [\"tex\"], function (tex) {\n    return tex.options({\n      displayMode: true,\n      fleqn: true\n    });\n  });\n  main.variable(observer(\"default_splink_settings\")).define(\"default_splink_settings\", function () {\n    return \"{\\n    \\\"proportion_of_matches\\\": 0.01,\\n    \\\"comparison_columns\\\": [\\n      {\\n        \\\"col_name\\\": \\\"fname\\\",\\n        \\\"u_probabilities\\\": [0.8, 0.2],\\n        \\\"m_probabilities\\\": [0.2, 0.8]\\n      },\\n      {\\n        \\\"col_name\\\": \\\"sname\\\",\\n        \\\"u_probabilities\\\": [0.9, 0.1],\\n        \\\"m_probabilities\\\": [0.2, 0.8]\\n      },\\n      {\\n        \\\"col_name\\\": \\\"dob\\\",\\n        \\\"u_probabilities\\\": [0.99, 0.01],\\n        \\\"m_probabilities\\\": [0.2, 0.8]\\n      },\\n      {\\n        \\\"col_name\\\": \\\"town\\\",\\n        \\\"u_probabilities\\\": [0.7, 0.3],\\n        \\\"m_probabilities\\\": [0.3, 0.7]\\n      }\\n    ]\\n  \\n  }\";\n  });\n  main.variable(observer(\"settings\")).define(\"settings\", [\"splink_settings\"], function (splink_settings) {\n    return JSON.parse(splink_settings);\n  });\n  main.variable(observer(\"css_styles\")).define(\"css_styles\", [\"html\"], function (html) {\n    return html(_templateObject52 || (_templateObject52 = _taggedTemplateLiteral([\"<style>\\n.katex-display>.katex { font-size: 1em}\\n.katex-display>.katex>.katex-html>.tag {right: unset; padding-left:4em}\\ntextarea {\\n    max-height: 1000em !important;\\n    font-family: monospace !important;\\n}\\n</style>\"])));\n  });\n  main.variable(observer(\"inputs\")).define(\"inputs\", [\"require\"], function (require) {\n    return require(\"@observablehq/inputs\");\n  });\n  return main;\n}","import _taggedTemplateLiteral from \"/home/runner/work/robinl.github.io/robinl.github.io/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4, _templateObject5, _templateObject6, _templateObject7, _templateObject8, _templateObject9, _templateObject10, _templateObject11, _templateObject12, _templateObject13, _templateObject14, _templateObject15, _templateObject16, _templateObject17, _templateObject18, _templateObject19, _templateObject20, _templateObject21, _templateObject22, _templateObject23, _templateObject24, _templateObject25, _templateObject26, _templateObject27, _templateObject28, _templateObject29, _templateObject30, _templateObject31, _templateObject32, _templateObject33, _templateObject34, _templateObject35, _templateObject36, _templateObject37, _templateObject38, _templateObject39, _templateObject40, _templateObject41, _templateObject42, _templateObject43, _templateObject44, _templateObject45, _templateObject46, _templateObject47, _templateObject48;\n\n// https://observablehq.com/@robinl/understanding-match-weights@644\nimport define1 from \"./ea6530af059f37be@228.js\";\nimport define2 from \"./817db6818ab226c0@104.js\";\nimport define3 from \"./843cb6e82d7c3d9b@474.js\";\nimport define4 from \"./86fc30325e4106c4@851.js\";\nexport default function define(runtime, observer) {\n  var main = runtime.module();\n  main.variable(observer(\"title\")).define(\"title\", [\"md\"], function (md) {\n    return md(_templateObject || (_templateObject = _taggedTemplateLiteral([\"# Understanding match weights\"])));\n  });\n  main.variable(observer(\"para_1\")).define(\"para_1\", [\"md\"], function (md) {\n    return md(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"Some columns are more important than others to the calculation of overall match probability.  For example, a match on date of birth provides stronger evidence in favour of a match than a match on gender.\\n\\nThe relative importance of columns is quantified in a model's _match weights_.\\n\\nIn this article, we explore the concept of match weights, using visualisations to help build intuition for how they work.  \\n\\nThe annex to this article presents the maths for how our implementation of the Fellegi Sunter model can be decomposed into a series of match weights.\\n\\n\"])));\n  });\n  main.variable(observer(\"para_2\")).define(\"para_2\", [\"md\", \"tex\"], function (md, tex) {\n    return md(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"## Match weights \\n\\nA single comparison column provides evidence in favour or against a match, but this evidence is rarely conclusive.  The ambiguity arises because any observation on the comparison column is consistent with two possibilities.\\n\\n\\n\\n- **A match on a column is consistent with the possibility that the entities match, but could also be due to two different entities sharing the same information (a 'collision').**\\n\\n  The comparative likelihood of these two possibilities is a measure of the amount of evidence in favour of a match.  That is, we want to compare:\\n  \\n  \", \" vs. \", \"\\n\\n  or, using the more succinct notation of m and u probabilities:\\n\\n  \", \" vs. \", \".\\n\\n\\n- **A non-match on a column is consistent with the possibility the entities differ, but could also be due to typos or other variations in how information has been recorded about the same entity.**\\n  \\n   The comparative likelihood of these two possibilities is a measure of the amount of evidence against a match.  \\n  \\n    \", \" vs. \", \"\\n\\n  or, using the more succinct notation of m and u probabilities:\\n\\n  \", \" vs. \", \".\\n\\nWe use the ratio of these values to compare their magnitude.  This ratio is known as a Bayes Factor.\\n\\n\"])), tex(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"operatorname{Pr}(\\text{column matches}|\\text{records match})\"], [\"\\\\operatorname{Pr}(\\\\text{column matches}|\\\\text{records match})\"]))), tex(_templateObject5 || (_templateObject5 = _taggedTemplateLiteral([\"operatorname{Pr}(\\text{column matches}|\\text{records do not match})\"], [\"\\\\operatorname{Pr}(\\\\text{column matches}|\\\\text{records do not match})\"]))), tex(_templateObject6 || (_templateObject6 = _taggedTemplateLiteral([\"m_\\text{col, level 1}\"], [\"m_\\\\text{col, level 1}\"]))), tex(_templateObject7 || (_templateObject7 = _taggedTemplateLiteral([\"u_\\text{col, level 1}\"], [\"u_\\\\text{col, level 1}\"]))), tex(_templateObject8 || (_templateObject8 = _taggedTemplateLiteral([\"operatorname{Pr}(\\text{column mismatches}|\\text{records match})\"], [\"\\\\operatorname{Pr}(\\\\text{column mismatches}|\\\\text{records match})\"]))), tex(_templateObject9 || (_templateObject9 = _taggedTemplateLiteral([\"operatorname{Pr}(\\text{column mismatches}|\\text{records do not match})\"], [\"\\\\operatorname{Pr}(\\\\text{column mismatches}|\\\\text{records do not match})\"]))), tex(_templateObject10 || (_templateObject10 = _taggedTemplateLiteral([\"m_\\text{col, level 0}\"], [\"m_\\\\text{col, level 0}\"]))), tex(_templateObject11 || (_templateObject11 = _taggedTemplateLiteral([\"u_\\text{col, level 0}\"], [\"u_\\\\text{col, level 0}\"]))));\n  });\n  main.variable(observer(\"para_3\")).define(\"para_3\", [\"md\", \"texd\", \"tex\"], function (md, texd, tex) {\n    return md(_templateObject12 || (_templateObject12 = _taggedTemplateLiteral([\"## Bayes Factors\\n\\nMathematically we can define the [Bayes Factor](https://betterexplained.com/articles/understanding-bayes-theorem-with-ratios/) for a given comparison column as:\\n\\n\", \"\\n\\n\\nBayes factors can be explained in words.  For example, a Bayes Factor of 20 for a given column means that an overall match is now 20 times more probable.  A Bayes Factor of \", \" for a given column means an overall match is 10 times less probable.\\n\\nIn this sense, a Bayes Factor is are similar to the concept of odds.  Odds of 4 mean that an even happens four out of five times, or in some sense it is four times more likely for the even to happen than not happen.\\n\\nHowever, Bayes Factors differ from odds in that they are only meaningful in the context of a prior.  A Bayes Factor is an adjustment - it tells us something is more or less likely.  But we need a starting value - otherwise there's nothing to apply the adjustment to.\\n\\nLet's see how this works:\\n\\n\\n\"])), texd(_templateObject13 || (_templateObject13 = _taggedTemplateLiteral([\"K_\\text{col, level} =  \\frac{m_\\text{col, level}}{u_\\text{col, level}}= \\frac{operatorname{Pr}(gamma_\\text{col,level}|\\text{records match})}{operatorname{Pr}(gamma_\\text{col,level}|\\text{records do not match})}\"], [\"K_\\\\text{col, level} =  \\\\frac{m_\\\\text{col, level}}{u_\\\\text{col, level}}= \\\\frac{\\\\operatorname{Pr}(\\\\gamma_\\\\text{col,level}|\\\\text{records match})}{\\\\operatorname{Pr}(\\\\gamma_\\\\text{col,level}|\\\\text{records do not match})}\"]))), tex(_templateObject14 || (_templateObject14 = _taggedTemplateLiteral([\"\\frac{1}{10}\"], [\"\\\\frac{1}{10}\"]))));\n  });\n  main.variable(observer(\"viewof prior\")).define(\"viewof prior\", [\"inputs\"], function (inputs) {\n    return inputs.range([0, 1], {\n      step: 0.01,\n      label: \"prior probability =\",\n      value: 0.5\n    });\n  });\n  main.variable(observer(\"prior\")).define(\"prior\", [\"Generators\", \"viewof prior\"], function (G, _) {\n    return G.input(_);\n  });\n  main.variable(observer(\"viewof m\")).define(\"viewof m\", [\"inputs\", \"tex\"], function (inputs, tex) {\n    return inputs.range([0, 1], {\n      step: 0.01,\n      label: tex(_templateObject15 || (_templateObject15 = _taggedTemplateLiteral([\"m_\\text{col, level} =\"], [\"m_\\\\text{col, level} =\"]))),\n      value: 0.8\n    });\n  });\n  main.variable(observer(\"m\")).define(\"m\", [\"Generators\", \"viewof m\"], function (G, _) {\n    return G.input(_);\n  });\n  main.variable(observer(\"viewof u\")).define(\"viewof u\", [\"inputs\", \"tex\"], function (inputs, tex) {\n    return inputs.range([0, 1], {\n      step: 0.01,\n      label: tex(_templateObject16 || (_templateObject16 = _taggedTemplateLiteral([\"u_\\text{col, level} =\"], [\"u_\\\\text{col, level} =\"]))),\n      value: 0.2\n    });\n  });\n  main.variable(observer(\"u\")).define(\"u\", [\"Generators\", \"viewof u\"], function (G, _) {\n    return G.input(_);\n  });\n  main.variable(observer(\"bf\")).define(\"bf\", [\"tex\", \"m\", \"u\"], function (tex, m, u) {\n    return tex(_templateObject17 || (_templateObject17 = _taggedTemplateLiteral([\"\\text{Bayes Factor} = \\frac{m_\\text{col, level}}{u_\\text{col, level}} = \\frac{\", \"}{\", \"} = \", \" \"], [\"\\\\text{Bayes Factor} = \\\\frac{m_\\\\text{col, level}}{u_\\\\text{col, level}} = \\\\frac{\", \"}{\", \"} = \", \" \"])), m, u, (m / u).toPrecision(4));\n  });\n  main.variable(observer(\"post\")).define(\"post\", [\"tex\", \"prior\", \"m\", \"u\"], function (tex, prior, m, u) {\n    return tex(_templateObject18 || (_templateObject18 = _taggedTemplateLiteral([\"\\text{posterior} = \\frac{\\text{prior}\\times m}{\\text{prior}\\times m + (1-\\text{prior})\\times u}= \", \"\"], [\"\\\\text{posterior} = \\\\frac{\\\\text{prior}\\\\times m}{\\\\text{prior}\\\\times m + (1-\\\\text{prior})\\\\times u}= \", \"\"])), (prior * m / (prior * m + (1 - prior) * u)).toPrecision(4));\n  });\n  main.variable(observer(\"subhead_1\")).define(\"subhead_1\", [\"md\"], function (md) {\n    return md(_templateObject19 || (_templateObject19 = _taggedTemplateLiteral([\"## Match weights\"])));\n  });\n  main.variable(observer(\"para_4\")).define(\"para_4\", [\"md\", \"texd\"], function (md, texd) {\n    return md(_templateObject20 || (_templateObject20 = _taggedTemplateLiteral([\"Finally, it can be convenient to take the logarithm of Bayes Factors because this [enables match weights to be added together](https://math.stackexchange.com/questions/965500/intuitive-understanding-of-logarithms) rather than being multiplied.\\n\\n\", \"\\n\\nThis transformation is also useful for visualising match weights.  Bayes factors are difficult to represent on a single scale becuse they represent ratios, which can be very large or very tiny, whereas log bayes factors can easily be viewed and compared on a single scale.\\n\"])), texd(_templateObject21 || (_templateObject21 = _taggedTemplateLiteral([\"\\text{match weight for dob} =  log(K_\\text{col, level})\"], [\"\\\\text{match weight for dob} =  \\\\log(K_\\\\text{col, level})\"]))));\n  });\n  main.variable(observer(\"para_5\")).define(\"para_5\", [\"md\", \"tex\", \"texd\"], function (md, tex, texd) {\n    return md(_templateObject22 || (_templateObject22 = _taggedTemplateLiteral([\"## Determinants of match weights\\n\\n### Column matches\\n\\nWhere a column matches, the key determinant of match weight is the cardinality of the column (the number of unique values).  \\n\\nFor example, imagine we are linking a dataset of children, and consider the date of birth field.\\n\\nThe Bayes Factor is \", \"  \\n\\nThe numerator is the probability that date of birth matches amongst records which truly match.\\n\\nThis is likely to be high.  With good data quality it will approach 1.0, and even with poor data quality it's likely to be above 0.8.\\n\\nThe term \", \" is the probability that date of birth matches amongst records which do not match.  \\n\\n\\nThis is likely to be very small.  If the children are aged below 18, then there will be \", \" = \", \" different dates of birth.  We can therefore estimate that:\\n\\n\", \"\\n\\nLet's assume that the numerator is 0.9.  The Bayes Factor would be \", \" = \", \"  i.e. very strong evidence in favour of a match.    \\n\\nThe denominator drives this result - the precise value of the numerator does not matter much.\\n\\n### Column does not match\\n\\nWhere a column does not match, the key deterinant of match weight is the probability of mismatches among records that truly match.  This could be due to typos, transcription errors, or other reasons for variation in data (e.g. change of address).  Loosely speaking, this is a measure of data quality.\\n\\nFor example, imagine we are linking a large dataset of people, and consider the gender field.  Imagine this is recorded with high precision, and for the sake of this example, suppose no-one in the dataset has changed their gender.\\n\\nThe Bayes Factor is \", \"  \\n\\nThe numerator tells us how often we observe a mismatch on gender amongst truly matching records.  Since data is entered with high precision, this number is low.  Let's say the rate of error is one in a thousand.\\n\\nThe denominator tells us how often we observe a mismatch on gender among truly non-matching records.  For gender this is likely to be around 0.5.  Note that the denominator would generally be a high number (almost always in the range 0.5 - 1.0) irrespective of the column type.\\n\\nThe Bayes Factor would be \", \" = \", \"  .  This is very strong evidence against a match.\\n\\nThe numerator drives this result - the precise value of the denominator does not matter.\\n\\n\\n\"])), tex(_templateObject23 || (_templateObject23 = _taggedTemplateLiteral([\"\\frac{m_\\text{dob, level 1}}{u_\\text{dob, level 1}}\"], [\"\\\\frac{m_\\\\text{dob, level 1}}{u_\\\\text{dob, level 1}}\"]))), tex(_templateObject24 || (_templateObject24 = _taggedTemplateLiteral([\"u_\\text{dob, level 1}\"], [\"u_\\\\text{dob, level 1}\"]))), tex(_templateObject25 || (_templateObject25 = _taggedTemplateLiteral([\"18 \\times 365\"], [\"18 \\\\times 365\"]))), (18 * 365).toLocaleString(), texd(_templateObject26 || (_templateObject26 = _taggedTemplateLiteral([\"u_\\text{dob, level 1} = \\frac{1}{\", \"} = \", \"\"], [\"u_\\\\text{dob, level 1} = \\\\frac{1}{\", \"} = \", \"\"])), 18 * 365, (1 / (18 * 365)).toPrecision(4)), tex(_templateObject27 || (_templateObject27 = _taggedTemplateLiteral([\"\\frac{0.9}{\", \"}\"], [\"\\\\frac{0.9}{\", \"}\"])), (1 / (18 * 365)).toPrecision(4)), 0.9 * 18 * 365, tex(_templateObject28 || (_templateObject28 = _taggedTemplateLiteral([\"\\frac{m_\\text{gender, level 0}}{u_\\text{gender, level 0}}\"], [\"\\\\frac{m_\\\\text{gender, level 0}}{u_\\\\text{gender, level 0}}\"]))), tex(_templateObject29 || (_templateObject29 = _taggedTemplateLiteral([\"\\frac{0.001}{0.5}\"], [\"\\\\frac{0.001}{0.5}\"]))), 0.001 / 0.5);\n  });\n  main.variable(observer(\"subhead_2\")).define(\"subhead_2\", [\"md\"], function (md) {\n    return md(_templateObject30 || (_templateObject30 = _taggedTemplateLiteral([\"## Visualising match weights\"])));\n  });\n  main.variable(observer(\"para_6\")).define(\"para_6\", [\"md\"], function (md) {\n    return md(_templateObject31 || (_templateObject31 = _taggedTemplateLiteral([\"These concepts allow us to succinctly summarise the m and u values and match weights of a Fellegi Sunter model graphically.  For instance, consider the following model: (*You may adjust the m and u values*):\"])));\n  });\n  main.variable(observer(\"para_7\")).define(\"para_7\", [\"md\"], function (md) {\n    return md(_templateObject32 || (_templateObject32 = _taggedTemplateLiteral([\"This allows a succinct visualisation of the match weights for a Fellegi Sunter model as follows.  You may edit these values to see how they affect the charts.\"])));\n  });\n  main.variable(observer(\"viewof splink_settings\")).define(\"viewof splink_settings\", [\"inputs\", \"default_splink_settings\"], function (inputs, default_splink_settings) {\n    return inputs.textarea({\n      value: default_splink_settings,\n      rows: 26,\n      spellcheck: false\n    });\n  });\n  main.variable(observer(\"splink_settings\")).define(\"splink_settings\", [\"Generators\", \"viewof splink_settings\"], function (G, _) {\n    return G.input(_);\n  });\n  main.variable(observer(\"para_8\")).define(\"para_8\", [\"md\"], function (md) {\n    return md(_templateObject33 || (_templateObject33 = _taggedTemplateLiteral([\"The m and u probabilities can be shown in the following chart:\"])));\n  });\n  main.variable(observer(\"chart_1\")).define(\"chart_1\", [\"get_m_u_chart\", \"splink_settings\"], function (get_m_u_chart, splink_settings) {\n    return get_m_u_chart(JSON.parse(splink_settings));\n  });\n  main.variable(observer(\"para_9\")).define(\"para_9\", [\"md\"], function (md) {\n    return md(_templateObject34 || (_templateObject34 = _taggedTemplateLiteral([\"And the Bayes Factors can be visualised as follows:\"])));\n  });\n  main.variable(observer(\"chart_2\")).define(\"chart_2\", [\"get_bayes_factor_chart\", \"splink_settings\"], function (get_bayes_factor_chart, splink_settings) {\n    return get_bayes_factor_chart(JSON.parse(splink_settings));\n  });\n  main.variable(observer(\"para_10\")).define(\"para_10\", [\"md\"], function (md) {\n    return md(_templateObject35 || (_templateObject35 = _taggedTemplateLiteral([\"## Waterfall chart\\n\\nFinally, for given values of the comparison columns, we can use the log 2 Bayes Factors to plot a chart that shows the calculation of the final probability.  The log 2 Bayes Factor is on the right hand access, and the probability is shown on the right hand axis.  Hover over the bars for more information.\"])));\n  });\n  main.variable(observer(\"viewof fname_radio\")).define(\"viewof fname_radio\", [\"inputs\"], function (inputs) {\n    return inputs.radio([\"Values do not match\", \"Values match\"], {\n      label: \"Comparison of fname column\",\n      value: \"Values match\"\n    });\n  });\n  main.variable(observer(\"fname_radio\")).define(\"fname_radio\", [\"Generators\", \"viewof fname_radio\"], function (G, _) {\n    return G.input(_);\n  });\n  main.variable(observer(\"viewof sname_radio\")).define(\"viewof sname_radio\", [\"inputs\"], function (inputs) {\n    return inputs.radio([\"Values do not match\", \"Values match\"], {\n      label: \"Comparison of sname column\",\n      value: \"Values match\"\n    });\n  });\n  main.variable(observer(\"sname_radio\")).define(\"sname_radio\", [\"Generators\", \"viewof sname_radio\"], function (G, _) {\n    return G.input(_);\n  });\n  main.variable(observer(\"viewof dob_radio\")).define(\"viewof dob_radio\", [\"inputs\"], function (inputs) {\n    return inputs.radio([\"Values do not match\", \"Values match\"], {\n      label: \"Comparison of dob column\",\n      value: \"Values match\"\n    });\n  });\n  main.variable(observer(\"dob_radio\")).define(\"dob_radio\", [\"Generators\", \"viewof dob_radio\"], function (G, _) {\n    return G.input(_);\n  });\n  main.variable(observer(\"viewof town_radio\")).define(\"viewof town_radio\", [\"inputs\"], function (inputs) {\n    return inputs.radio([\"Values do not match\", \"Values match\"], {\n      label: \"Comparison of town column\",\n      value: \"Values do not match\"\n    });\n  });\n  main.variable(observer(\"town_radio\")).define(\"town_radio\", [\"Generators\", \"viewof town_radio\"], function (G, _) {\n    return G.input(_);\n  });\n  main.variable(observer(\"chart_3\")).define(\"chart_3\", [\"get_waterfall_chart\", \"row\", \"splink_settings\"], function (get_waterfall_chart, row, splink_settings) {\n    return get_waterfall_chart(row, JSON.parse(splink_settings), {\n      height: 300\n    }, false);\n  });\n  main.variable(observer(\"para_11\")).define(\"para_11\", [\"md\", \"get_match_probability_components\", \"row\", \"splink_settings\"], function (md, get_match_probability_components, row, splink_settings) {\n    return md(_templateObject36 || (_templateObject36 = _taggedTemplateLiteral([\"Final match probability:\\n\", \"\"])), get_match_probability_components(row, JSON.parse(splink_settings))[\"match_probability\"].toPrecision(4));\n  });\n  main.variable(observer(\"annex\")).define(\"annex\", [\"md\"], function (md) {\n    return md(_templateObject37 || (_templateObject37 = _taggedTemplateLiteral([\"## Mathematical annex: Rewriting the Fellegi Sunter formula in terms of odds, and Bayes Factors\"])));\n  });\n  main.variable(observer(\"para_12\")).define(\"para_12\", [\"md\", \"texd\"], function (md, texd) {\n    return md(_templateObject38 || (_templateObject38 = _taggedTemplateLiteral([\"In this section, we show why it is possible to compute match probabilities by adding together log2 Bayes Factors.\\n\\nStart with our equation for match probability:\\n\\n\", \"\\n\\nAnd note that we could similarly define:\\n\\n\", \"\\n\\n\"])), texd(_templateObject39 || (_templateObject39 = _taggedTemplateLiteral([\"\\noperatorname{Pr}(\\text{records match}|gamma_{1},gamma_{2},ldots,gamma_{K}) = \\frac{lambda m_{1ell}m_{2ell}ldots m_{Kell}}{lambda m_{1ell}m_{2ell}ldots m_{Kell}+ (1-lambda)u_{1ell}u_{1ell} ldots u_{Kell}}\\tag{1.1} \"], [\"\\n\\\\operatorname{Pr}(\\\\text{records match}|\\\\gamma_{1},\\\\gamma_{2},\\\\ldots,\\\\gamma_{K}) = \\\\frac{\\\\lambda m_{1\\\\ell}m_{2\\\\ell}\\\\ldots m_{K\\\\ell}}{\\\\lambda m_{1\\\\ell}m_{2\\\\ell}\\\\ldots m_{K\\\\ell}+ (1-\\\\lambda)u_{1\\\\ell}u_{1\\\\ell} \\\\ldots u_{K\\\\ell}}\\\\tag{1.1} \"]))), texd(_templateObject40 || (_templateObject40 = _taggedTemplateLiteral([\"\\noperatorname{Pr}(\\text{records do not match}|gamma_{1},gamma_{2},ldots,gamma_{K}) = \\frac{(1-lambda) u_{1ell}u_{2ell}ldots u_{Kell}}{lambda m_{1ell}m_{2ell}ldots m_{Kell}+ (1-lambda)u_{1ell}u_{1ell} ldots u_{Kell}}\\tag{1.2} \"], [\"\\n\\\\operatorname{Pr}(\\\\text{records do not match}|\\\\gamma_{1},\\\\gamma_{2},\\\\ldots,\\\\gamma_{K}) = \\\\frac{(1-\\\\lambda) u_{1\\\\ell}u_{2\\\\ell}\\\\ldots u_{K\\\\ell}}{\\\\lambda m_{1\\\\ell}m_{2\\\\ell}\\\\ldots m_{K\\\\ell}+ (1-\\\\lambda)u_{1\\\\ell}u_{1\\\\ell} \\\\ldots u_{K\\\\ell}}\\\\tag{1.2} \"]))));\n  });\n  main.variable(observer(\"para_13\")).define(\"para_13\", [\"md\", \"texd\"], function (md, texd) {\n    return md(_templateObject41 || (_templateObject41 = _taggedTemplateLiteral([\"Now we introduce the [formula for odds](https://en.wikipedia.org/wiki/Odds#Statistical_usage): \\n\\n\", \" \\nwhere p is probability.\\n\\n\\nFor example odds of 4 mean that this event happens 4 out of 5 times, which correponds to a probability of 80%.\\n\\nDividing (1.1) by (1.2) we see that:\\n\\n\", \"\\n\\nAlso recall that the Bayes Factor for column i can be defined as:\\n\", \" \\nso we can write the odds that records match as :\\n\\n\", \"\\n\\n\\nWhich can then be converted into a probability using:\\n\\n\", \"\\n\\nSometimes it can also be convenient to use log odds, because these can be computed with addition rather than multiplication:\\n\\n\", \"\\n\\nThis final representation is what is used in the waterfall chart to represent the computation of match probability\\n\"])), texd(_templateObject42 || (_templateObject42 = _taggedTemplateLiteral([\"\\text{odds} = \\frac{p}{1-p}\"], [\"\\\\text{odds} = \\\\frac{p}{1-p}\"]))), texd(_templateObject43 || (_templateObject43 = _taggedTemplateLiteral([\"\\n\\text{odds}(\\text{records  match}|gamma_{1},gamma_{2},ldots,gamma_{K}) = \\frac{lambda m_{1ell}m_{2ell}ldots m_{Kell}}{(1-lambda) u_{1ell}u_{2ell}ldots u_{Kell}}\\tag{1.3} \"], [\"\\n\\\\text{odds}(\\\\text{records  match}|\\\\gamma_{1},\\\\gamma_{2},\\\\ldots,\\\\gamma_{K}) = \\\\frac{\\\\lambda m_{1\\\\ell}m_{2\\\\ell}\\\\ldots m_{K\\\\ell}}{(1-\\\\lambda) u_{1\\\\ell}u_{2\\\\ell}\\\\ldots u_{K\\\\ell}}\\\\tag{1.3} \"]))), texd(_templateObject44 || (_templateObject44 = _taggedTemplateLiteral([\"b_{iell}=\\frac{m_{iell}}{u_{iell}}\"], [\"b_{i\\\\ell}=\\\\frac{m_{i\\\\ell}}{u_{i\\\\ell}}\"]))), texd(_templateObject45 || (_templateObject45 = _taggedTemplateLiteral([\"\\n\\text{odds of match} = \\frac{lambda }{(1-lambda) } b_{1ell}b_{2ell}ldots b_{Kell}\\tag{1.4} \"], [\"\\n\\\\text{odds of match} = \\\\frac{\\\\lambda }{(1-\\\\lambda) } b_{1\\\\ell}b_{2\\\\ell}\\\\ldots b_{K\\\\ell}\\\\tag{1.4} \"]))), texd(_templateObject46 || (_templateObject46 = _taggedTemplateLiteral([\"p = \\frac{\\text{odds}}{1+\\text{odds}}\"], [\"p = \\\\frac{\\\\text{odds}}{1+\\\\text{odds}}\"]))), texd(_templateObject47 || (_templateObject47 = _taggedTemplateLiteral([\"\\n\\text{log odds of match} = log{(\\frac{lambda }{(1-lambda) })} log({b_{1ell}})+log({b_{2ell}})+ldots +log({b_{Kell})}\\tag{1.5} \"], [\"\\n\\\\text{log odds of match} = \\\\log{(\\\\frac{\\\\lambda }{(1-\\\\lambda) })} \\\\log({b_{1\\\\ell}})+\\\\log({b_{2\\\\ell}})+\\\\ldots +\\\\log({b_{K\\\\ell})}\\\\tag{1.5} \"]))));\n  });\n  main.variable(observer(\"texd\")).define(\"texd\", [\"tex\"], function (tex) {\n    return tex.options({\n      displayMode: true,\n      fleqn: true\n    });\n  });\n  main.variable(observer(\"css_styles\")).define(\"css_styles\", [\"html\"], function (html) {\n    return html(_templateObject48 || (_templateObject48 = _taggedTemplateLiteral([\"<style>\\n.katex-display>.katex { font-size: 1em}\\n.katex-display {\\n    max-width: None;\\n}\\ntextarea {\\n    max-height: 1000em !important;\\n    font-family: monospace !important;\\n}\\n</style>\"])));\n  });\n  var child1 = runtime.module(define1);\n  main.import(\"intro_simple_waterfall\", child1);\n  var child2 = runtime.module(define2);\n  main.import(\"get_m_u_chart\", child2);\n  main.import(\"get_bayes_factor_chart\", child2);\n  main.import(\"default_splink_settings\", child2);\n  var child3 = runtime.module(define3);\n  main.import(\"get_waterfall_chart\", child3);\n  main.variable(observer(\"row\")).define(\"row\", [\"fname_radio\", \"sname_radio\", \"dob_radio\", \"town_radio\"], function (fname_radio, sname_radio, dob_radio, town_radio) {\n    var row = {};\n\n    if (fname_radio == \"Values match\") {\n      row[\"𝛾_fname\"] = 1;\n    } else {\n      row[\"𝛾_fname\"] = 0;\n    }\n\n    if (sname_radio == \"Values match\") {\n      row[\"𝛾_sname\"] = 1;\n    } else {\n      row[\"𝛾_sname\"] = 0;\n    }\n\n    if (dob_radio == \"Values match\") {\n      row[\"𝛾_dob\"] = 1;\n    } else {\n      row[\"𝛾_dob\"] = 0;\n    }\n\n    if (town_radio == \"Values match\") {\n      row[\"𝛾_town\"] = 1;\n    } else {\n      row[\"𝛾_town\"] = 0;\n    }\n\n    return row;\n  });\n  var child4 = runtime.module(define4);\n  main.import(\"get_match_probability_components\", child4);\n  main.variable(observer(\"inputs\")).define(\"inputs\", [\"require\"], function (require) {\n    return require(\"@observablehq/inputs@0.8.0\");\n  });\n  return main;\n}","import React from 'react'\nimport define from \"@robinl/understanding-match-weights\"\nimport ProbLinkagePage from \"../components/prob_linkage_page\"\nimport { css } from \"@emotion/core\"\n\nexport const frontmatter = {\n    title: \"Understanding match weights in the Fellegi Sunter model\",\n    post_date: \"2021-05-07\",\n    code_url: \"https://observablehq.com/@robinl/understanding-match-weights\",\n    post_type: \"obs\",\n    post_category: \"probabilistic_linkage\",\n    description: \"An set of interactive, explorable explanations of the Fellegi Sunter model of probabilistic record linkage.  This article discusses match weights.\"\n}\n\nlet output_order = [\n    \"title\",\n    \"para_1\",\n    \"para_2\",\n    \"para_3\",\n    \"viewof prior\",\n    \"viewof m\",\n    \"viewof u\",\n    \"bf\",\n    \"post\",\n    \"subhead_1\",\n    \"para_4\",\n    \"para_5\",\n    \"subhead_2\",\n    \"para_6\",\n    \"para_7\",\n    \"viewof splink_settings\",\n    \"para_8\",\n    \"chart_1\",\n    \"para_9\",\n    \"chart_2\",\n    \"para_10\",\n    \"viewof fname_radio\",\n    \"viewof sname_radio\",\n    \"viewof dob_radio\",\n    \"viewof town_radio\",\n    \"chart_3\",\n    \"para_11\",\n    \"annex\",\n    \"para_12\",\n    \"para_13\",\n    \"css_styles\"\n]\n\nconst css_override = css`\nmargin-left: auto;\nmargin-right: auto;\nwidth: 90%;\nmax-width: 800px;\ntable {font-size: 0.8rem;\n line-height: 1rem;}\nrem;\n`\n\nexport default (props) => {\n\n    return (<ProbLinkagePage\n        define={define}\n        output_order={output_order}\n        post_frontmatter={frontmatter}\n        css={css_override}\n        current_path={props.path}\n    />)\n\n\n}\n"],"sourceRoot":""}